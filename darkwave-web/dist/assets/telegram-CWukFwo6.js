import{j as e,T as S,r as n,c as v,d as b,e as w,f as C}from"./SniperBotTab-oBftqwc0.js";import{T as A,i as E,S as I,j as f,h as B,W}from"./components-Lit5CWvC.js";class z extends n.Component{constructor(t){super(t),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){console.error("TelegramApp error:",t,r),this.setState({errorInfo:r})}render(){if(this.state.hasError){const t=this.state.error?.message||this.state.error?.toString()||"Unknown error occurred";this.state.error?.stack;const r=this.state.errorInfo?.componentStack||"";return e.jsxs("div",{style:{padding:"20px",textAlign:"center",background:"#0f0f0f",minHeight:"100vh",color:"#fff"},children:[e.jsx("div",{style:{fontSize:"48px",marginBottom:"16px"},children:"âš ï¸"}),e.jsx("h2",{style:{marginBottom:"12px",fontSize:"18px"},children:"Something went wrong"}),e.jsxs("div",{style:{background:"#1a1a1a",padding:"12px",borderRadius:"8px",marginBottom:"16px",textAlign:"left",maxHeight:"200px",overflow:"auto"},children:[e.jsx("p",{style:{color:"#ff6b6b",fontSize:"12px",margin:0,wordBreak:"break-word"},children:t}),r&&e.jsx("pre",{style:{color:"#888",fontSize:"10px",marginTop:"8px",whiteSpace:"pre-wrap"},children:r.slice(0,500)})]}),e.jsx("button",{onClick:()=>window.location.reload(),style:{padding:"12px 24px",background:"linear-gradient(135deg, #00D4FF, #00A0CC)",color:"#000",border:"none",borderRadius:"8px",cursor:"pointer",fontWeight:600},children:"Reload App"})]})}return this.props.children}}const R=[{id:"sniper",label:"StrikeAgent",icon:"ðŸŽ¯"},{id:"wallet",label:"Wallet",icon:"ðŸ’³"},{id:"pricing",label:"Upgrade",icon:"âš¡"}];function F({activeTab:i,onTabChange:t}){return e.jsx("nav",{style:{position:"fixed",bottom:0,left:0,right:0,background:"#0f0f0f",borderTop:"1px solid rgba(0, 212, 255, 0.15)",display:"flex",justifyContent:"space-around",padding:"8px 0 max(8px, env(safe-area-inset-bottom))",zIndex:1e3},children:R.map(r=>{const s=i===r.id;return e.jsxs("button",{onClick:()=>t(r.id),style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"4px",background:"transparent",border:"none",padding:"8px 16px",cursor:"pointer",color:s?"#00d4ff":"#666",transition:"color 0.2s ease",position:"relative"},children:[e.jsx("span",{style:{fontSize:"20px"},children:r.icon}),e.jsx("span",{style:{fontSize:"11px",fontWeight:s?"600":"400",textTransform:"uppercase",letterSpacing:"0.5px"},children:r.label}),s&&e.jsx("span",{style:{position:"absolute",bottom:"4px",width:"24px",height:"2px",background:"#00d4ff",borderRadius:"1px"}})]},r.id)})})}function H(){const{telegramUser:i,isReady:t,webApp:r}=E(),[s,j]=n.useState("sniper"),[c,g]=n.useState(null),[o,u]=n.useState(null),[l,x]=n.useState(!1);n.useEffect(()=>{i?.id&&g(`telegram_${i.id}`)},[i]),n.useEffect(()=>{(async()=>{try{const d=await fetch("/api/session");if(d.ok){const p=await d.json();if(p.user?.email){g(p.user.email);const m=await fetch(`/api/users/${p.user.email}/dashboard`);if(m.ok){const y=await m.json();u(y)}}}}catch{console.log("Session check failed, using defaults")}})()},[]),n.useEffect(()=>{r&&t&&(r.setHeaderColor?.("#0f0f0f"),r.setBackgroundColor?.("#0f0f0f"))},[r,t]);const k=(a="impact")=>{if(r?.HapticFeedback)switch(a){case"impact":r.HapticFeedback.impactOccurred("medium");break;case"notification":r.HapticFeedback.notificationOccurred("success");break;case"selection":r.HapticFeedback.selectionChanged();break}},h=a=>{k("selection"),a==="settings"?x(!0):(x(!1),j(a))},T=()=>{if(l)return e.jsx(I,{userId:c,userConfig:o,setUserConfig:u,isTelegram:!0});switch(s){case"sniper":return e.jsx(f,{requiredTier:"rm-plus",featureName:"StrikeAgent AI Trading",mode:"overlay",currentTier:o?.subscriptionTier,children:e.jsx(b,{isTelegram:!0})});case"wallet":return e.jsx(f,{requiredTier:"rm-plus",featureName:"Wallet Transactions",mode:"overlay",currentTier:o?.subscriptionTier,children:e.jsx(W,{userId:c,isTelegram:!0})});case"pricing":return e.jsx(B,{userId:c,currentTier:o?.subscriptionTier,isTelegram:!0});default:return e.jsx(f,{requiredTier:"rm-plus",featureName:"StrikeAgent AI Trading",mode:"overlay",currentTier:o?.subscriptionTier,children:e.jsx(b,{isTelegram:!0})})}};return t?e.jsx(v,{children:e.jsxs("div",{style:{minHeight:"100vh",background:"#0f0f0f",color:"#fff",paddingBottom:"80px"},children:[e.jsxs("header",{style:{position:"sticky",top:0,background:"#0f0f0f",borderBottom:"1px solid rgba(0, 212, 255, 0.1)",padding:"12px 16px",display:"flex",alignItems:"center",justifyContent:"space-between",zIndex:100},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx("span",{style:{fontSize:"24px"},children:"ðŸŽ¯"}),e.jsx("span",{style:{fontWeight:"700",fontSize:"18px",background:"linear-gradient(135deg, #00d4ff, #00ff88)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:"StrikeAgent"})]}),e.jsx("button",{onClick:()=>h("settings"),style:{background:"transparent",border:"none",padding:"8px",cursor:"pointer",fontSize:"20px",opacity:l?1:.6},children:"âš™ï¸"})]}),e.jsx("main",{style:{padding:"0 12px"},children:T()}),!l&&e.jsx(F,{activeTab:s,onTabChange:h})]})}):e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh",background:"#0f0f0f",color:"#00d4ff"},children:[e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{width:50,height:50,border:"3px solid #00d4ff",borderTopColor:"transparent",borderRadius:"50%",animation:"spin 1s linear infinite",margin:"0 auto 16px"}}),e.jsx("p",{style:{margin:0,fontSize:"14px"},children:"Loading StrikeAgent..."})]}),e.jsx("style",{children:`
          @keyframes spin {
            to { transform: rotate(360deg); }
          }
        `})]})}function U(){return e.jsx(z,{children:e.jsx(S,{children:e.jsx(A,{children:e.jsx(H,{})})})})}"caches"in window&&caches.keys().then(i=>{i.forEach(t=>{caches.delete(t),console.log("[Telegram] Cleared cache:",t)})});"serviceWorker"in navigator&&navigator.serviceWorker.getRegistrations().then(i=>{i.forEach(t=>{t.unregister(),console.log("[Telegram] Unregistered service worker")})});w.createRoot(document.getElementById("root")).render(e.jsx(n.StrictMode,{children:e.jsx(C,{children:e.jsx(U,{})})}));
