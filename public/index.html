<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#0F172A">
  <title>DarkWave PULSE - Real-Time Market Analysis</title>
  <link rel="stylesheet" href="/styles.css">
  <link rel="icon" type="image/png" href="/darkwave-coin.png">
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <script src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>
</head>
<body class="theme-jupiter">
  <div id="app">
    
    <!-- Live Market Ticker -->
    <div class="market-ticker">
      <div class="ticker-wrapper">
        <div id="tickerContent" class="ticker-content"></div>
        <div id="tickerContentClone" class="ticker-content"></div>
      </div>
    </div>

    <main class="app-main" style="max-width: 1200px; margin: 0 auto; padding: 16px;">
      
      <!-- Header Banner -->
      <header class="wave-banner-unified">
        <div class="wave-watermark"></div>
        <div class="wave-banner-content">
          <h1 class="digital-title-unified">DarkWave</h1>
          <p class="digital-subtitle-unified">PULSE</p>
        </div>
        <div style="position: absolute; top: 12px; right: 12px; z-index: 10;">
          <button class="icon-btn" id="adminBtn" title="Admin" style="background: linear-gradient(135deg, #FF006E, #8B5CF6);">ğŸ”</button>
        </div>
      </header>

      <!-- Compact Top Bar: Search + Pricing -->
      <div style="display: grid; grid-template-columns: 1fr auto; gap: 12px; margin: 16px 0; align-items: center;">
        
        <!-- Search Web3 -->
        <div class="universal-search-container">
          <div class="search-box-wrapper-oval">
            <span class="search-icon">ğŸ”</span>
            <input 
              type="text" 
              id="universalSearchInput" 
              class="universal-search-input-oval" 
              placeholder="Search Crypto, Stocks, NFTs..."
              autocomplete="off"
            />
            <button id="universalSearchBtn" class="universal-search-btn-oval">Search Web3</button>
          </div>
        </div>

        <!-- Compact Pricing Box -->
        <div style="background: linear-gradient(135deg, rgba(59, 130, 246, 0.15), rgba(139, 92, 246, 0.15)); border-radius: 8px; padding: 12px 16px; border: 1px solid var(--primary); min-width: 220px;">
          <div style="font-size: 0.75rem; color: var(--text-secondary); margin-bottom: 6px; text-align: center;">ğŸš€ Premium Access</div>
          <div style="display: flex; gap: 8px;">
            <button onclick="subscribePlan('basic')" style="flex: 1; padding: 6px 10px; background: var(--bg-secondary); color: var(--text-primary); border: 1px solid var(--border-primary); border-radius: 6px; cursor: pointer; font-size: 0.75rem; font-weight: 600;">Basic $2</button>
            <button onclick="subscribePlan('premium')" style="flex: 1; padding: 6px 10px; background: var(--primary); color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 0.75rem; font-weight: 600;">Premium $6</button>
          </div>
        </div>
        
      </div>

      <!-- Analysis Results Area -->
      <div id="analysisResults" style="margin: 16px 0; min-height: 200px;">
        <div class="welcome-message" style="text-align: center; padding: 40px; color: var(--text-secondary);">
          <h2 style="color: var(--text-primary); margin-bottom: 8px;">Real-Time Market Intelligence</h2>
          <p>Search any asset for instant technical analysis</p>
        </div>
      </div>

      <!-- Asset Class Tabs -->
      <section class="asset-tabs" style="margin: 32px 0;">
        <div style="display: flex; gap: 8px; margin-bottom: 24px; border-bottom: 2px solid var(--border-primary); padding-bottom: 2px;">
          <button class="asset-tab active" data-asset="crypto" onclick="switchAsset('crypto')" style="flex: 1; padding: 12px; background: transparent; border: none; border-bottom: 3px solid var(--primary); color: var(--text-primary); font-weight: 600; cursor: pointer; transition: all 0.3s;">
            ğŸª™ CRYPTO
          </button>
          <button class="asset-tab" data-asset="stocks" onclick="switchAsset('stocks')" style="flex: 1; padding: 12px; background: transparent; border: none; border-bottom: 3px solid transparent; color: var(--text-secondary); font-weight: 600; cursor: pointer; transition: all 0.3s;">
            ğŸ“ˆ STOCKS
          </button>
          <button class="asset-tab" data-asset="nfts" onclick="switchAsset('nfts')" style="flex: 1; padding: 12px; background: transparent; border: none; border-bottom: 3px solid transparent; color: var(--text-secondary); font-weight: 600; cursor: pointer; transition: all 0.3s;">
            ğŸ¨ NFTs
          </button>
        </div>

        <!-- Category Filters (dynamic per asset) -->
        <div class="category-buttons" style="display: flex; gap: 8px; margin-bottom: 16px; flex-wrap: wrap;">
          <button class="category-btn active" data-category="top" onclick="loadCategory('top')">Top 50</button>
          <button class="category-btn" data-category="gainers" onclick="loadCategory('gainers')">ğŸŸ¢ Gainers</button>
          <button class="category-btn" data-category="losers" onclick="loadCategory('losers')">ğŸ”´ Losers</button>
          <button class="category-btn" data-category="trending" onclick="loadCategory('trending')">ğŸ”¥ Trending</button>
        </div>

        <!-- Market Table -->
        <div id="marketTableContainer" style="overflow-x: auto; border-radius: 8px; background: var(--bg-secondary); padding: 16px;">
          <table class="market-table" id="marketTable" style="width: 100%; border-collapse: collapse;">
            <thead>
              <tr style="border-bottom: 1px solid var(--border-primary);">
                <th style="text-align: left; padding: 12px; color: var(--text-secondary); font-size: 0.875rem;">#</th>
                <th style="text-align: left; padding: 12px; color: var(--text-secondary); font-size: 0.875rem;">Name</th>
                <th style="text-align: right; padding: 12px; color: var(--text-secondary); font-size: 0.875rem;">Price</th>
                <th style="text-align: right; padding: 12px; color: var(--text-secondary); font-size: 0.875rem;">24h %</th>
                <th style="text-align: right; padding: 12px; color: var(--text-secondary); font-size: 0.875rem;">Market Cap</th>
                <th style="text-align: right; padding: 12px; color: var(--text-secondary); font-size: 0.875rem;">Volume</th>
                <th style="text-align: center; padding: 12px; color: var(--text-secondary); font-size: 0.875rem;">RSI</th>
                <th style="text-align: center; padding: 12px; color: var(--text-secondary); font-size: 0.875rem;">Action</th>
              </tr>
            </thead>
            <tbody id="marketTableBody">
              <tr>
                <td colspan="8" style="text-align: center; padding: 40px; color: var(--text-secondary);">Loading...</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- News Links (Simple Hyperlinks) -->
      <section class="news-section" style="margin: 32px 0;">
        <h3 style="color: var(--text-primary); margin-bottom: 12px; font-size: 1.125rem;">ğŸ“° Market News</h3>
        <div id="newsLinks" style="display: flex; flex-direction: column; gap: 6px;">
          <a href="#" class="news-link" style="color: var(--primary); text-decoration: none; font-size: 0.875rem;">Loading news...</a>
        </div>
      </section>

      <!-- Footer with Crypto Cat House Link -->
      <footer style="margin-top: 64px; padding: 32px; text-align: center; border-top: 1px solid var(--border-primary);">
        <a href="https://cryptocathouse.com" target="_blank" rel="noopener" style="display: inline-block; transition: transform 0.3s ease; text-decoration: none;">
          <img src="/crypto-cat-mascot.png" alt="Crypto Cat House" style="width: 100px; height: 100px; border-radius: 12px; margin-bottom: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.3);" />
          <div style="color: var(--primary); font-size: 1rem; font-weight: 600;">Visit Crypto Cat House</div>
          <div style="color: var(--text-secondary); font-size: 0.875rem; margin-top: 4px;">cryptocathouse.com</div>
        </a>
        <div style="margin-top: 24px; color: var(--text-tertiary); font-size: 0.75rem;">
          &copy; 2025 DarkWave PULSE | Professional Market Analysis Tool
        </div>
      </footer>

    </main>

    <!-- AI Chat Widget (Floating) -->
    <div class="ai-agent-widget" id="aiAgentWidget" style="position: fixed; bottom: 24px; right: 24px; z-index: 1000;">
      <button class="ai-agent-toggle" id="aiAgentToggle" style="width: 60px; height: 60px; border-radius: 50%; background: linear-gradient(135deg, var(--primary), #8B5CF6); border: none; padding: 0; cursor: pointer; box-shadow: 0 4px 12px rgba(0,0,0,0.3); transition: all 0.3s; overflow: hidden;">
        <img src="/assets/crypto-cat-emblem.png" alt="Crypto Cat AI" style="width: 100%; height: 100%; object-fit: cover;" />
      </button>
      <div class="ai-agent-box" id="aiAgentBox" style="display: none; position: absolute; bottom: 80px; right: 0; width: 350px; max-height: 500px; background: var(--bg-secondary); border: 1px solid var(--border-primary); border-radius: 12px; box-shadow: 0 8px 24px rgba(0,0,0,0.4); overflow: hidden;">
        <div class="crypto-cat-ai-header" style="padding: 16px; background: linear-gradient(135deg, var(--primary), #8B5CF6); color: white; display: flex; align-items: center; gap: 12px;">
          <img src="/crypto-cat-mascot.png" alt="Crypto Cat" style="width: 40px; height: 40px; border-radius: 50%;" />
          <div style="flex: 1;">
            <h3 style="margin: 0; font-size: 1rem;">Crypto Cat AI</h3>
            <p style="margin: 0; font-size: 0.75rem; opacity: 0.9;">Smartass Mode</p>
          </div>
          <button class="close-btn-sm" id="closeChatBtn" style="background: none; border: none; color: white; font-size: 1.5rem; cursor: pointer;">&times;</button>
        </div>
        <div class="ai-agent-messages" id="aiAgentMessages" style="padding: 16px; max-height: 300px; overflow-y: auto;">
          <div class="ai-message" style="background: rgba(255,255,255,0.05); padding: 12px; border-radius: 8px; margin-bottom: 12px;">
            <strong>Crypto Cat:</strong> Ask me about any asset, trading strategies, or market analysis.
          </div>
        </div>
        <div class="ai-agent-input-area" style="padding: 16px; border-top: 1px solid var(--border-primary); display: flex; gap: 8px;">
          <input type="text" id="aiAgentInput" placeholder="Ask Crypto Cat..." style="flex: 1; padding: 8px 12px; background: var(--bg-tertiary); border: 1px solid var(--border-primary); border-radius: 8px; color: var(--text-primary);" />
          <button class="ai-send-btn" id="aiSendBtn" style="padding: 8px 16px; background: var(--primary); border: none; border-radius: 8px; color: white; cursor: pointer; font-weight: 600;">â¤</button>
        </div>
      </div>
    </div>

    <!-- Chart Modal -->
    <div id="chartModal" class="modal-backdrop" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.8); z-index: 2000; align-items: center; justify-content: center;">
      <div class="modal-content" style="background: var(--bg-primary); border-radius: 16px; max-width: 1000px; width: 90%; max-height: 90vh; overflow: hidden; box-shadow: 0 12px 48px rgba(0,0,0,0.6);">
        <div class="modal-header" style="padding: 20px; border-bottom: 1px solid var(--border-primary); display: flex; justify-content: space-between; align-items: center;">
          <h3 id="chartModalTitle" style="margin: 0; color: var(--text-primary);">Price Chart</h3>
          <button class="close-btn" id="closeChartBtn" style="background: none; border: none; color: var(--text-secondary); font-size: 2rem; cursor: pointer; line-height: 1;">&times;</button>
        </div>
        <div class="modal-body" style="padding: 20px;">
          <div class="chart-controls" style="display: flex; gap: 8px; margin-bottom: 16px; flex-wrap: wrap;">
            <button class="chart-btn active" data-timeframe="1D">1D</button>
            <button class="chart-btn" data-timeframe="1W">1W</button>
            <button class="chart-btn" data-timeframe="1M">1M</button>
            <button class="chart-btn" data-timeframe="3M">3M</button>
            <button class="chart-btn" data-timeframe="1Y">1Y</button>
            <div style="flex: 1;"></div>
            <button class="chart-btn" data-type="candlestick">ğŸ“Š Candle</button>
            <button class="chart-btn" data-type="line">ğŸ“ˆ Line</button>
          </div>
          <div id="chartContainer" style="height: 500px; background: rgba(0,0,0,0.3); border-radius: 8px;"></div>
        </div>
      </div>
    </div>

  </div>

  <script src="/app.js"></script>
</body>
</html>
