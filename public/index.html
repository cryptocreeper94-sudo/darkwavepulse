<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>ğŸŒŠ DarkWave-V2</title>
  <link rel="stylesheet" href="/mini-app/styles.css">
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
  <!-- Header with Banner Image -->
  <header class="app-header banner-header">
    <img src="/telegram-banner.png" alt="DarkWave-V2 Banner" class="header-banner-image">
    <div class="header-actions-overlay">
      <button class="icon-btn" id="refreshBtn">ğŸ”„</button>
      <button class="icon-btn" id="settingsBtn">âš™ï¸</button>
    </div>
  </header>

  <!-- Main Content -->
  <main class="app-main">
    <!-- Tab Navigation -->
    <nav class="tab-nav">
      <button class="tab-btn active" data-tab="analysis">
        <span class="tab-icon">ğŸ“Š</span>
        <span class="tab-label">Analysis</span>
      </button>
      <button class="tab-btn" data-tab="holdings">
        <span class="tab-icon">â­</span>
        <span class="tab-label">Holdings</span>
      </button>
      <button class="tab-btn" data-tab="wallet">
        <span class="tab-icon">ğŸ’°</span>
        <span class="tab-label">Wallet</span>
      </button>
      <button class="tab-btn" data-tab="settings">
        <span class="tab-icon">âš™ï¸</span>
        <span class="tab-label">Settings</span>
      </button>
    </nav>

    <!-- Tab Content -->
    <div class="tab-content">
      <!-- Analysis Tab -->
      <div id="analysis" class="tab-pane active">
        <!-- Category Navigation -->
        <div class="category-nav">
          <button class="category-btn active" data-category="bluechip">
            <span class="category-icon">ğŸ”µ</span>
            <span class="category-label">Blue Chip</span>
          </button>
          <button class="category-btn" data-category="stocks">
            <span class="category-icon">ğŸ“ˆ</span>
            <span class="category-label">Stocks</span>
          </button>
          <button class="category-btn" data-category="meme">
            <span class="category-icon">ğŸ¸</span>
            <span class="category-label">Meme</span>
          </button>
          <button class="category-btn" data-category="defi">
            <span class="category-icon">ğŸ’</span>
            <span class="category-label">DeFi</span>
          </button>
          <button class="category-btn" data-category="dex">
            <span class="category-icon">ğŸ”„</span>
            <span class="category-label">DEX</span>
          </button>
        </div>

        <!-- Blockchain Filter (for crypto categories) -->
        <div id="blockchainFilter" class="blockchain-filter">
          <div class="filter-label">Chain:</div>
          <button class="filter-chip active" data-chain="all">All</button>
          <button class="filter-chip" data-chain="solana">Solana</button>
          <button class="filter-chip" data-chain="ethereum">Ethereum</button>
          <button class="filter-chip" data-chain="base">Base</button>
          <button class="filter-chip" data-chain="bsc">BSC</button>
        </div>

        <!-- Search Container -->
        <div class="search-container">
          <input type="text" id="searchInput" class="search-input" placeholder="Search ticker...">
          <button class="search-btn" id="searchBtn">ğŸ”</button>
        </div>

        <!-- Quick Picks (Dynamic per category) -->
        <div id="quickPicksContainer" class="quick-picks-section"></div>

        <!-- Analysis Result -->
        <div id="analysisResult" class="analysis-result">
          <div class="welcome-card">
            <div class="welcome-icon">ğŸ”µ</div>
            <h2>Blue Chip Crypto</h2>
            <p>Top market cap cryptocurrencies with proven track records</p>
          </div>
        </div>

        <div id="loadingSpinner" class="loading-spinner hidden">
          <div class="spinner"></div>
          <p>Analyzing...</p>
        </div>
      </div>

      <!-- Holdings Tab -->
      <div id="holdings" class="tab-pane">
        <div class="section-header">
          <h2>ğŸ“Š Your Watchlist</h2>
          <button class="action-btn" id="scanBtn">ğŸ” Scan Market</button>
        </div>
        <div id="holdingsList" class="holdings-list">
          <div class="empty-state">
            <div class="empty-icon">â­</div>
            <p>No holdings yet</p>
            <button class="action-btn" id="addHoldingBtn">+ Add Ticker</button>
          </div>
        </div>
      </div>

      <!-- Wallet Tab -->
      <div id="wallet" class="tab-pane">
        <div class="section-header">
          <h2>ğŸ’° Wallet</h2>
        </div>
        <div id="walletContent" class="wallet-content">
          <!-- Connection Section -->
          <div class="wallet-card" id="walletConnectCard">
            <div class="wallet-status">
              <span class="status-label">Status:</span>
              <span class="status-badge disconnected" id="walletStatus">Not Connected</span>
            </div>
            
            <div id="walletInputSection">
              <label style="display: block; margin-bottom: 8px; color: var(--text-secondary); font-size: 0.9rem;">
                Enter your Phantom wallet public address:
              </label>
              <input 
                type="text" 
                id="walletAddressInput" 
                placeholder="e.g., 7xKXtg2CW87d97TXJSDpbD5jBkheTqA83TZRuJosgAsU"
                style="width: 100%; padding: 12px; border: 1px solid rgba(168, 85, 247, 0.3); border-radius: 8px; background: rgba(255,255,255,0.05); color: white; font-size: 0.9rem; margin-bottom: 12px; font-family: monospace;"
              />
              <button class="primary-btn" id="connectWalletBtn" style="width: 100%;">
                Connect Wallet
              </button>
              <p class="wallet-hint" style="margin-top: 8px; font-size: 0.85rem; color: var(--text-secondary); text-align: center;">
                ğŸ”’ We only store your public address (read-only, 100% safe)
              </p>
            </div>

            <div id="walletDisconnectSection" class="hidden">
              <div style="background: rgba(74, 222, 128, 0.1); padding: 12px; border-radius: 8px; margin-bottom: 12px;">
                <div style="font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 4px;">Connected Address:</div>
                <div style="font-family: monospace; font-size: 0.9rem; color: #4ADE80; word-break: break-all;" id="fullWalletAddress"></div>
              </div>
              <button class="action-btn" id="disconnectWalletBtn" style="width: 100%; background: rgba(230, 57, 70, 0.2); border-color: #E63946;">
                Disconnect Wallet
              </button>
            </div>
          </div>

          <!-- Balance & Info Section -->
          <div id="walletBalance" class="wallet-balance hidden">
            <h3 style="margin-bottom: 16px;">ğŸ’ Balance</h3>
            <div class="balance-card">
              <div class="balance-item">
                <span class="balance-label">SOL</span>
                <span class="balance-value" id="solBalance">0.00</span>
              </div>
            </div>
            <button class="action-btn" id="refreshBalanceBtn" style="width: 100%; margin-top: 12px;">
              ğŸ”„ Refresh Balance
            </button>
          </div>

          <!-- Limit Orders Section -->
          <div id="limitOrdersSection" class="hidden" style="margin-top: 20px;">
            <h3 style="margin-bottom: 16px;">ğŸ“Š Limit Orders</h3>
            
            <div id="ordersList" style="margin-bottom: 16px;">
              <div class="empty-state" style="text-align: center; padding: 20px; background: rgba(255,255,255,0.02); border-radius: 8px;">
                <p style="color: var(--text-secondary); font-size: 0.9rem;">No active orders</p>
              </div>
            </div>

            <button class="action-btn" id="createOrderBtn" style="width: 100%;">
              + Create Limit Order
            </button>

            <div id="createOrderForm" class="hidden" style="margin-top: 16px; padding: 16px; background: rgba(255,255,255,0.05); border-radius: 8px;">
              <h4 style="margin-bottom: 12px; font-size: 0.9rem;">New Limit Order</h4>
              <select id="orderType" style="width: 100%; padding: 10px; margin-bottom: 10px; border: 1px solid rgba(168, 85, 247, 0.3); border-radius: 6px; background: rgba(255,255,255,0.05); color: white;">
                <option value="buy">Buy</option>
                <option value="sell">Sell</option>
              </select>
              <input type="text" id="orderTicker" placeholder="Token (e.g., BONK)" style="width: 100%; padding: 10px; margin-bottom: 10px; border: 1px solid rgba(168, 85, 247, 0.3); border-radius: 6px; background: rgba(255,255,255,0.05); color: white;" />
              <input type="number" id="orderPrice" placeholder="Target Price ($)" step="0.0001" style="width: 100%; padding: 10px; margin-bottom: 10px; border: 1px solid rgba(168, 85, 247, 0.3); border-radius: 6px; background: rgba(255,255,255,0.05); color: white;" />
              <input type="number" id="orderAmount" placeholder="Amount (SOL or tokens)" step="0.01" style="width: 100%; padding: 10px; margin-bottom: 12px; border: 1px solid rgba(168, 85, 247, 0.3); border-radius: 6px; background: rgba(255,255,255,0.05); color: white;" />
              <div style="display: flex; gap: 8px;">
                <button class="action-btn" id="submitOrderBtn" style="flex: 1;">Create</button>
                <button class="action-btn" id="cancelOrderFormBtn" style="flex: 1; background: rgba(230, 57, 70, 0.2); border-color: #E63946;">Cancel</button>
              </div>
            </div>
          </div>

          <!-- Token Sniping Section -->
          <div id="snipingSection" class="hidden" style="margin-top: 20px;">
            <h3 style="margin-bottom: 16px;">ğŸ¯ Token Sniping</h3>
            
            <div style="background: rgba(255,255,255,0.05); padding: 16px; border-radius: 8px; margin-bottom: 16px;">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                <span style="font-size: 0.9rem;">Status:</span>
                <span id="snipingStatus" style="padding: 4px 12px; border-radius: 12px; background: rgba(230, 57, 70, 0.2); color: #E63946; font-size: 0.85rem;">Disabled</span>
              </div>
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; font-size: 0.85rem;">
                <div>
                  <div style="color: var(--text-secondary);">Min Liquidity</div>
                  <div id="snipingMinLiq" style="font-weight: 600;">$10,000</div>
                </div>
                <div>
                  <div style="color: var(--text-secondary);">Max Rug Score</div>
                  <div id="snipingMaxRug" style="font-weight: 600;">30/100</div>
                </div>
                <div>
                  <div style="color: var(--text-secondary);">Max Buy Amount</div>
                  <div id="snipingMaxBuy" style="font-weight: 600;">0.1 SOL</div>
                </div>
                <div>
                  <div style="color: var(--text-secondary);">Auto-Execute</div>
                  <div id="snipingAutoExecute" style="font-weight: 600;">OFF</div>
                </div>
              </div>
            </div>

            <button class="action-btn" id="configureSnipingBtn" style="width: 100%;">
              âš™ï¸ Configure Sniping
            </button>
          </div>
        </div>
      </div>

      <!-- Settings Tab -->
      <div id="settings" class="tab-pane">
        <div class="section-header">
          <h2>âš™ï¸ Control Center</h2>
        </div>
        <div class="settings-content">
          <div class="settings-section">
            <h3>ğŸ”” Price Alerts</h3>
            <div class="toggle-row">
              <span>Enable Alerts</span>
              <label class="toggle-switch">
                <input type="checkbox" id="toggleAlerts">
                <span class="toggle-slider"></span>
              </label>
            </div>
            <div class="toggle-row">
              <span>Auto-Monitor Watchlist</span>
              <label class="toggle-switch">
                <input type="checkbox" id="toggleAutoMonitor">
                <span class="toggle-slider"></span>
              </label>
            </div>
          </div>

          <div class="settings-section">
            <h3>ğŸ¯ Trading</h3>
            <div class="toggle-row">
              <span>Sniping Enabled</span>
              <label class="toggle-switch">
                <input type="checkbox" id="toggleSniping">
                <span class="toggle-slider"></span>
              </label>
            </div>
            <div class="toggle-row">
              <span>Auto-Execute Orders</span>
              <label class="toggle-switch">
                <input type="checkbox" id="toggleAutoExecute">
                <span class="toggle-slider"></span>
              </label>
            </div>
          </div>

          <div class="settings-section">
            <h3>ğŸ” Analysis Scope</h3>
            <div class="scope-buttons">
              <button class="scope-btn" data-scope="stocks">ğŸ“Š Stocks</button>
              <button class="scope-btn" data-scope="coins">ğŸª™ Crypto</button>
              <button class="scope-btn active" data-scope="both">ğŸ“ŠğŸª™ Both</button>
            </div>
          </div>

          <div class="settings-section">
            <h3>ğŸ”— Exchange Links</h3>
            <div class="scope-buttons">
              <button class="scope-btn" data-exchange="kraken">Kraken</button>
              <button class="scope-btn active" data-exchange="dexscreener">Dexscreener</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Toast Notifications -->
  <div id="toast" class="toast hidden"></div>

  <script src="/mini-app/app.js"></script>
</body>
</html>
