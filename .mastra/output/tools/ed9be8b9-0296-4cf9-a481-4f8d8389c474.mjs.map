{"version":3,"file":"ed9be8b9-0296-4cf9-a481-4f8d8389c474.mjs","sources":["../../../src/mastra/tools/userSettingsTool.ts"],"sourcesContent":["import { createTool } from '@mastra/core/tools';\nimport { z } from 'zod';\n\n/**\n * User Settings Tool - Manages bot preferences and toggles\n * Stores user preferences like auto-execute, exchange links, safety limits\n */\n\nexport const userSettingsTool = createTool({\n  id: 'user-settings',\n  description: `Control Center - Manages ALL bot settings and toggles with simple on/off commands. \n  Use this when the user wants to:\n  - View all settings (\"settings\")\n  - Toggle features (\"on alerts\", \"off sniping\", \"on auto trading\")\n  - Change asset scope (\"stocks only\", \"coins only\", \"both\")\n  - Change exchange links (\"kraken links\", \"dex links\")\n  - Set spending limits (\"set max spend 0.5\")\n  - Any simple toggle or preference change\n  \n  This is the MAIN settings interface - users prefer toggles over complex commands.`,\n  inputSchema: z.object({\n    action: z.enum(['view', 'update']).describe('View or update settings'),\n    userId: z.string().describe('User ID from Telegram'),\n    settings: z.object({\n      autoExecuteLimitOrders: z.boolean().optional().describe('Auto-execute limit orders when triggered'),\n      autoExecuteSniping: z.boolean().optional().describe('Auto-execute token sniping when criteria met'),\n      defaultExchangeLink: z.enum(['kraken', 'dexscreener']).optional().describe('Default exchange for hyperlinks'),\n      maxAutoSpendPerTrade: z.number().optional().describe('Max SOL to spend per auto-executed trade'),\n      snipingEnabled: z.boolean().optional().describe('Enable/disable sniping features'),\n      priceAlertsEnabled: z.boolean().optional().describe('Enable/disable price alert monitoring'),\n      assetScope: z.enum(['coins', 'stocks', 'both']).optional().describe('Which assets to analyze'),\n      autoMonitorWatchlist: z.boolean().optional().describe('Auto-create alerts for watchlist items'),\n      personalityMode: z.enum(['regular', 'cryptoCat']).optional().describe('AI personality: regular (professional) or cryptoCat (sarcastic, fun)'),\n    }).optional(),\n  }),\n  outputSchema: z.object({\n    success: z.boolean(),\n    message: z.string(),\n    settings: z.object({\n      autoExecuteLimitOrders: z.boolean(),\n      autoExecuteSniping: z.boolean(),\n      defaultExchangeLink: z.string(),\n      maxAutoSpendPerTrade: z.number(),\n      snipingEnabled: z.boolean(),\n      priceAlertsEnabled: z.boolean(),\n      assetScope: z.string(),\n      autoMonitorWatchlist: z.boolean(),\n      personalityMode: z.string(),\n    }).optional(),\n  }),\n  execute: async ({ context, mastra, runtimeContext }) => {\n    const logger = mastra?.getLogger();\n    const { action, settings } = context;\n    const userId = context.userId || (runtimeContext as any)?.resourceId || 'default-user';\n    const SETTINGS_KEY = `user_settings_${userId}`;\n\n    logger?.info('‚öôÔ∏è [UserSettings] Starting settings operation', {\n      action,\n      userId,\n    });\n\n    try {\n      const memory = mastra?.memory;\n      \n      // Get current settings from memory\n      let currentSettings = {\n        autoExecuteLimitOrders: false,\n        autoExecuteSniping: false,\n        defaultExchangeLink: 'dexscreener',\n        maxAutoSpendPerTrade: 0.1, // 0.1 SOL default (~$15-20)\n        snipingEnabled: false,\n        priceAlertsEnabled: false,\n        assetScope: 'both', // coins, stocks, or both\n        autoMonitorWatchlist: false,\n        personalityMode: 'regular', // regular or cryptoCat\n      };\n      \n      try {\n        if (memory) {\n          const messages = await memory.getMessages({\n            resourceId: userId,\n            threadId: SETTINGS_KEY,\n          });\n          \n          if (messages && messages.length > 0) {\n            const lastMessage = messages[messages.length - 1];\n            if (lastMessage.content) {\n              currentSettings = { ...currentSettings, ...JSON.parse(lastMessage.content as string) };\n            }\n          }\n        }\n      } catch (e) {\n        logger?.warn('[UserSettings] No existing settings found, using defaults');\n      }\n\n      if (action === 'view') {\n        logger?.info('üëÅÔ∏è [UserSettings] Viewing Control Center', { userId });\n\n        const toggle = (enabled: boolean) => enabled ? '‚úÖ ON' : '‚ùå OFF';\n        const safeMode = !currentSettings.autoExecuteLimitOrders && !currentSettings.autoExecuteSniping;\n        \n        // Check wallet status from memory\n        let walletStatus = '‚ùå Not connected';\n        try {\n          if (memory) {\n            const walletMessages = await memory.getMessages({\n              resourceId: userId,\n              threadId: `wallet_${userId}`,\n            });\n            if (walletMessages && walletMessages.length > 0) {\n              const lastWallet = walletMessages[walletMessages.length - 1];\n              if (lastWallet.content) {\n                const walletData = JSON.parse(lastWallet.content as string);\n                if (walletData.publicKey) {\n                  const short = walletData.publicKey.slice(0, 6) + '...' + walletData.publicKey.slice(-4);\n                  walletStatus = `‚úÖ ${short}`;\n                }\n              }\n            }\n          }\n        } catch (e) {\n          // No wallet connected\n        }\n        \n        const controlCenter = `\n‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó\n‚ïë   üåä DarkWave Control Center V2.1    ‚ïë\n‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\n\nüì± WALLET\n‚îú‚îÄ Status: ${walletStatus}\n‚îî‚îÄ Quick: \"connect wallet\" | \"disconnect\"\n\nüéØ PRICE ALERTS\n‚îú‚îÄ Enabled: ${toggle(currentSettings.priceAlertsEnabled)}\n‚îú‚îÄ Auto-monitor watchlist: ${toggle(currentSettings.autoMonitorWatchlist)}\n‚îî‚îÄ Quick: \"on alerts\" | \"BTC alert 65000\"\n\nüí± TRADING ${safeMode ? '(SAFE MODE ‚úÖ)' : '(AUTO MODE ‚ö†Ô∏è)'}\n‚îú‚îÄ Auto-execute orders: ${toggle(currentSettings.autoExecuteLimitOrders)}\n‚îú‚îÄ Max spend: ${currentSettings.maxAutoSpendPerTrade} SOL/trade\n‚îî‚îÄ Exchange links: ${currentSettings.defaultExchangeLink}\n\nüéØ SNIPING\n‚îú‚îÄ Enabled: ${toggle(currentSettings.snipingEnabled)}\n‚îú‚îÄ Auto-execute: ${toggle(currentSettings.autoExecuteSniping)}\n‚îî‚îÄ Quick: \"on sniping\" | \"off sniping\"\n\nüîç ANALYSIS\n‚îú‚îÄ Asset scope: ${currentSettings.assetScope === 'both' ? 'üìä Stocks + ü™ô Crypto' : currentSettings.assetScope === 'stocks' ? 'üìä Stocks only' : 'ü™ô Crypto only'}\n‚îî‚îÄ Quick: \"stocks only\" | \"coins only\" | \"both\"\n\nüé≠ PERSONALITY\n‚îú‚îÄ Mode: ${currentSettings.personalityMode === 'regular' ? 'üéØ Professional' : 'üò∫ Crypto Cat (Sarcastic)'}\n‚îî‚îÄ Quick: \"mode regular\" | \"mode cat\"\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n‚ú® SUPER SIMPLE COMMANDS:\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\nToggle anything:\n  \"on [feature]\" ‚Üí Enable\n  \"off [feature]\" ‚Üí Disable\n  \nExamples:\n  \"on auto trading\" \"off sniping\"\n  \"stocks only\" \"coins only\"\n  \"kraken links\" \"dex links\"\n  \"mode cat\" \"mode regular\"\n  \n${!safeMode ? '\\n‚ö†Ô∏è AUTO-TRADING ACTIVE - Bot will execute trades automatically!\\n' : ''}`.trim();\n        \n        return {\n          success: true,\n          message: controlCenter,\n          settings: currentSettings,\n        };\n      }\n\n      if (action === 'update') {\n        if (!settings) {\n          return {\n            success: false,\n            message: 'No settings provided to update',\n          };\n        }\n\n        // Merge new settings\n        const updatedSettings = { ...currentSettings, ...settings };\n\n        // Validation\n        if (updatedSettings.maxAutoSpendPerTrade < 0 || updatedSettings.maxAutoSpendPerTrade > 10) {\n          return {\n            success: false,\n            message: 'Max auto-spend must be between 0 and 10 SOL for safety',\n          };\n        }\n\n        // Save to memory\n        if (memory) {\n          await memory.saveMessages({\n            messages: [{\n              role: 'assistant',\n              content: JSON.stringify(updatedSettings),\n            }],\n            resourceId: userId,\n            threadId: SETTINGS_KEY,\n          });\n        }\n\n        logger?.info('‚úÖ [UserSettings] Settings updated', {\n          userId,\n          changes: settings,\n        });\n\n        // Build update message\n        let updateMsg = '‚úÖ Settings updated:\\n\\n';\n        if (settings.autoExecuteLimitOrders !== undefined) {\n          updateMsg += `${settings.autoExecuteLimitOrders ? '‚úÖ' : '‚ùå'} Auto-execute limit orders: ${settings.autoExecuteLimitOrders ? 'ENABLED' : 'DISABLED'}\\n`;\n        }\n        if (settings.autoExecuteSniping !== undefined) {\n          updateMsg += `${settings.autoExecuteSniping ? '‚úÖ' : '‚ùå'} Auto-execute sniping: ${settings.autoExecuteSniping ? 'ENABLED' : 'DISABLED'}\\n`;\n        }\n        if (settings.snipingEnabled !== undefined) {\n          updateMsg += `${settings.snipingEnabled ? '‚úÖ' : '‚ùå'} Sniping features: ${settings.snipingEnabled ? 'ENABLED' : 'DISABLED'}\\n`;\n        }\n        if (settings.priceAlertsEnabled !== undefined) {\n          updateMsg += `${settings.priceAlertsEnabled ? '‚úÖ' : '‚ùå'} Price alerts: ${settings.priceAlertsEnabled ? 'ENABLED' : 'DISABLED'}\\n`;\n        }\n        if (settings.autoMonitorWatchlist !== undefined) {\n          updateMsg += `${settings.autoMonitorWatchlist ? '‚úÖ' : '‚ùå'} Auto-monitor watchlist: ${settings.autoMonitorWatchlist ? 'ENABLED' : 'DISABLED'}\\n`;\n        }\n        if (settings.assetScope) {\n          const scopeText = settings.assetScope === 'both' ? 'üìä Stocks + ü™ô Crypto' : \n                           settings.assetScope === 'stocks' ? 'üìä Stocks only' : 'ü™ô Crypto only';\n          updateMsg += `üîç Asset scope: ${scopeText}\\n`;\n        }\n        if (settings.defaultExchangeLink) {\n          updateMsg += `üîó Exchange links: ${settings.defaultExchangeLink}\\n`;\n        }\n        if (settings.maxAutoSpendPerTrade !== undefined) {\n          updateMsg += `üí∞ Max auto-spend: ${settings.maxAutoSpendPerTrade} SOL/trade\\n`;\n        }\n        if (settings.personalityMode) {\n          const modeEmoji = settings.personalityMode === 'regular' ? 'üéØ' : 'üò∫';\n          const modeName = settings.personalityMode === 'regular' ? 'Professional Mode' : 'Crypto Cat Mode (Sarcastic)';\n          updateMsg += `${modeEmoji} Personality: ${modeName}\\n`;\n        }\n\n        if (updatedSettings.autoExecuteLimitOrders || updatedSettings.autoExecuteSniping) {\n          updateMsg += `\\n‚ö†Ô∏è AUTO-TRADING ENABLED - The bot will execute trades automatically using your connected wallet.`;\n        } else {\n          updateMsg += `\\n‚úÖ SAFE MODE - All trades require manual approval in Phantom.`;\n        }\n\n        return {\n          success: true,\n          message: updateMsg,\n          settings: updatedSettings,\n        };\n      }\n\n      return {\n        success: false,\n        message: 'Unknown action',\n      };\n    } catch (error) {\n      logger?.error('‚ùå [UserSettings] Error:', error);\n      return {\n        success: false,\n        message: `Error: ${error instanceof Error ? error.message : 'Unknown error'}`,\n      };\n    }\n  },\n});\n"],"names":[],"mappings":"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"}