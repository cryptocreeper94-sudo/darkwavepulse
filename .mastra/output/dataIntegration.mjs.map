{"version":3,"file":"dataIntegration.mjs","sources":["../../src/mastra/ai/dataIntegration.ts"],"sourcesContent":["import axios from 'axios';\n\nasync function retryWithBackoff<T>(\n  fn: () => Promise<T>,\n  maxRetries: number = 3,\n  baseDelay: number = 1000\n): Promise<T> {\n  let lastError: Error | null = null;\n  \n  for (let i = 0; i < maxRetries; i++) {\n    try {\n      return await fn();\n    } catch (error: any) {\n      lastError = error;\n      if (i < maxRetries - 1) {\n        const delay = baseDelay * Math.pow(2, i);\n        await new Promise(resolve => setTimeout(resolve, delay));\n      }\n    }\n  }\n  \n  throw lastError;\n}\n\nexport interface MarketDataSource {\n  name: string;\n  type: 'crypto' | 'stock' | 'onchain' | 'sentiment';\n  priority: number;\n  rateLimit: number;\n  enabled: boolean;\n}\n\nexport const dataSources: MarketDataSource[] = [\n  { name: 'coingecko', type: 'crypto', priority: 1, rateLimit: 50, enabled: true },\n  { name: 'dexscreener', type: 'crypto', priority: 2, rateLimit: 100, enabled: true },\n  { name: 'helius', type: 'onchain', priority: 1, rateLimit: 100, enabled: true },\n  { name: 'yahoofinance', type: 'stock', priority: 1, rateLimit: 200, enabled: true },\n  { name: 'finnhub', type: 'stock', priority: 2, rateLimit: 60, enabled: true },\n  { name: 'cryptocompare', type: 'sentiment', priority: 1, rateLimit: 100, enabled: false },\n  { name: 'santiment', type: 'sentiment', priority: 2, rateLimit: 50, enabled: false },\n  { name: 'glassnode', type: 'onchain', priority: 2, rateLimit: 30, enabled: false },\n  { name: 'lunarcrush', type: 'sentiment', priority: 3, rateLimit: 100, enabled: false },\n  { name: 'messari', type: 'crypto', priority: 3, rateLimit: 100, enabled: false },\n];\n\nexport interface UnifiedMarketData {\n  ticker: string;\n  name: string;\n  price: number;\n  change24h: number;\n  change7d?: number;\n  volume24h: number;\n  marketCap?: number;\n  high24h?: number;\n  low24h?: number;\n  ath?: number;\n  athDate?: string;\n  circulatingSupply?: number;\n  totalSupply?: number;\n  sources: string[];\n  timestamp: Date;\n}\n\nexport interface OnChainData {\n  ticker: string;\n  chain: string;\n  holders?: number;\n  transactions24h?: number;\n  activeAddresses24h?: number;\n  whaleHoldings?: number;\n  topHoldersPercent?: number;\n  liquidityUsd?: number;\n  sources: string[];\n  timestamp: Date;\n}\n\nexport interface SentimentData {\n  ticker: string;\n  overallScore: number;\n  twitterMentions?: number;\n  twitterSentiment?: number;\n  redditMentions?: number;\n  redditSentiment?: number;\n  newsArticles?: number;\n  newsSentiment?: number;\n  fearGreedIndex?: number;\n  sources: string[];\n  timestamp: Date;\n}\n\nexport class DataIntegrationLayer {\n  private cache: Map<string, { data: any; expires: number }> = new Map();\n  private cacheTimeout = 60000;\n\n  constructor(private logger?: any) {}\n\n  private getCached<T>(key: string): T | null {\n    const cached = this.cache.get(key);\n    if (cached && cached.expires > Date.now()) {\n      return cached.data as T;\n    }\n    return null;\n  }\n\n  private setCache(key: string, data: any, timeout?: number): void {\n    this.cache.set(key, {\n      data,\n      expires: Date.now() + (timeout || this.cacheTimeout)\n    });\n  }\n\n  async fetchCryptoData(ticker: string): Promise<UnifiedMarketData | null> {\n    const cacheKey = `crypto:${ticker}`;\n    const cached = this.getCached<UnifiedMarketData>(cacheKey);\n    if (cached) return cached;\n\n    const sources: string[] = [];\n    let data: Partial<UnifiedMarketData> = {\n      ticker: ticker.toUpperCase(),\n      sources: [],\n      timestamp: new Date()\n    };\n\n    try {\n      const cgResponse = await retryWithBackoff(async () => {\n        return axios.get(\n          `https://api.coingecko.com/api/v3/simple/price`,\n          {\n            params: {\n              ids: this.tickerToCoingeckoId(ticker),\n              vs_currencies: 'usd',\n              include_24hr_change: true,\n              include_24hr_vol: true,\n              include_market_cap: true\n            },\n            timeout: 5000\n          }\n        );\n      }, 3, 500);\n\n      const coinId = this.tickerToCoingeckoId(ticker);\n      if (cgResponse.data[coinId]) {\n        const coinData = cgResponse.data[coinId];\n        data.price = coinData.usd;\n        data.change24h = coinData.usd_24h_change;\n        data.volume24h = coinData.usd_24h_vol;\n        data.marketCap = coinData.usd_market_cap;\n        sources.push('coingecko');\n      }\n    } catch (error) {\n      this.logger?.warn('CoinGecko fetch failed after retries', { ticker, error });\n    }\n\n    try {\n      const dexResponse = await retryWithBackoff(async () => {\n        return axios.get(\n          `https://api.dexscreener.com/latest/dex/search?q=${ticker}`,\n          { timeout: 5000 }\n        );\n      }, 3, 500);\n\n      if (dexResponse.data?.pairs?.length > 0) {\n        const pair = dexResponse.data.pairs[0];\n        if (!data.price) {\n          data.price = parseFloat(pair.priceUsd);\n        }\n        if (!data.change24h) {\n          data.change24h = pair.priceChange?.h24 || 0;\n        }\n        if (!data.volume24h) {\n          data.volume24h = pair.volume?.h24 || 0;\n        }\n        data.name = pair.baseToken?.name;\n        sources.push('dexscreener');\n      }\n    } catch (error) {\n      this.logger?.warn('Dexscreener fetch failed after retries', { ticker, error });\n    }\n\n    if (!data.price) {\n      return null;\n    }\n\n    data.sources = sources;\n    const result = data as UnifiedMarketData;\n    this.setCache(cacheKey, result);\n    return result;\n  }\n\n  async fetchStockData(ticker: string): Promise<UnifiedMarketData | null> {\n    const cacheKey = `stock:${ticker}`;\n    const cached = this.getCached<UnifiedMarketData>(cacheKey);\n    if (cached) return cached;\n\n    const sources: string[] = [];\n    let data: Partial<UnifiedMarketData> = {\n      ticker: ticker.toUpperCase(),\n      sources: [],\n      timestamp: new Date()\n    };\n\n    try {\n      const yhResponse = await axios.get(\n        `https://query1.finance.yahoo.com/v8/finance/chart/${ticker}`,\n        {\n          params: { interval: '1d', range: '5d' },\n          timeout: 5000\n        }\n      );\n\n      const quote = yhResponse.data?.chart?.result?.[0];\n      if (quote) {\n        const meta = quote.meta;\n        data.price = meta.regularMarketPrice;\n        data.name = meta.shortName;\n        data.change24h = ((meta.regularMarketPrice - meta.previousClose) / meta.previousClose) * 100;\n        data.volume24h = meta.regularMarketVolume;\n        data.high24h = meta.regularMarketDayHigh;\n        data.low24h = meta.regularMarketDayLow;\n        sources.push('yahoofinance');\n      }\n    } catch (error) {\n      this.logger?.warn('Yahoo Finance fetch failed', { ticker, error });\n    }\n\n    if (process.env.FINNHUB_API_KEY && !data.price) {\n      try {\n        const fhResponse = await axios.get(\n          `https://finnhub.io/api/v1/quote`,\n          {\n            params: { symbol: ticker, token: process.env.FINNHUB_API_KEY },\n            timeout: 5000\n          }\n        );\n\n        if (fhResponse.data?.c) {\n          data.price = fhResponse.data.c;\n          data.change24h = fhResponse.data.dp;\n          data.high24h = fhResponse.data.h;\n          data.low24h = fhResponse.data.l;\n          sources.push('finnhub');\n        }\n      } catch (error) {\n        this.logger?.warn('Finnhub fetch failed', { ticker, error });\n      }\n    }\n\n    if (!data.price) {\n      return null;\n    }\n\n    data.sources = sources;\n    const result = data as UnifiedMarketData;\n    this.setCache(cacheKey, result);\n    return result;\n  }\n\n  async fetchOnChainData(ticker: string, chain: string = 'solana'): Promise<OnChainData | null> {\n    const cacheKey = `onchain:${chain}:${ticker}`;\n    const cached = this.getCached<OnChainData>(cacheKey);\n    if (cached) return cached;\n\n    const sources: string[] = [];\n    let data: Partial<OnChainData> = {\n      ticker: ticker.toUpperCase(),\n      chain,\n      sources: [],\n      timestamp: new Date()\n    };\n\n    if (chain === 'solana' && process.env.HELIUS_API_KEY) {\n      try {\n        sources.push('helius');\n      } catch (error) {\n        this.logger?.warn('Helius fetch failed', { ticker, error });\n      }\n    }\n\n    data.sources = sources;\n    const result = data as OnChainData;\n    this.setCache(cacheKey, result);\n    return result;\n  }\n\n  async fetchSentimentData(ticker: string): Promise<SentimentData | null> {\n    const cacheKey = `sentiment:${ticker}`;\n    const cached = this.getCached<SentimentData>(cacheKey);\n    if (cached) return cached;\n\n    const sources: string[] = [];\n    let data: Partial<SentimentData> = {\n      ticker: ticker.toUpperCase(),\n      overallScore: 50,\n      sources: [],\n      timestamp: new Date()\n    };\n\n    try {\n      const fgiResponse = await axios.get(\n        'https://api.alternative.me/fng/',\n        { timeout: 5000 }\n      );\n\n      if (fgiResponse.data?.data?.[0]) {\n        data.fearGreedIndex = parseInt(fgiResponse.data.data[0].value);\n        sources.push('alternative.me');\n      }\n    } catch (error) {\n      this.logger?.warn('Fear & Greed fetch failed', { error });\n    }\n\n    data.sources = sources;\n    const result = data as SentimentData;\n    this.setCache(cacheKey, result);\n    return result;\n  }\n\n  async fetchUnifiedData(ticker: string): Promise<{\n    market: UnifiedMarketData | null;\n    onchain: OnChainData | null;\n    sentiment: SentimentData | null;\n  }> {\n    const isStock = this.isStockTicker(ticker);\n    \n    const [market, onchain, sentiment] = await Promise.all([\n      isStock ? this.fetchStockData(ticker) : this.fetchCryptoData(ticker),\n      isStock ? Promise.resolve(null) : this.fetchOnChainData(ticker),\n      this.fetchSentimentData(ticker)\n    ]);\n\n    return { market, onchain, sentiment };\n  }\n\n  private tickerToCoingeckoId(ticker: string): string {\n    const mapping: Record<string, string> = {\n      'BTC': 'bitcoin',\n      'ETH': 'ethereum',\n      'SOL': 'solana',\n      'BNB': 'binancecoin',\n      'XRP': 'ripple',\n      'ADA': 'cardano',\n      'DOGE': 'dogecoin',\n      'DOT': 'polkadot',\n      'MATIC': 'matic-network',\n      'AVAX': 'avalanche-2',\n      'SHIB': 'shiba-inu',\n      'LINK': 'chainlink',\n      'UNI': 'uniswap',\n      'ATOM': 'cosmos',\n      'LTC': 'litecoin',\n      'PEPE': 'pepe',\n      'BONK': 'bonk',\n      'WIF': 'dogwifcoin',\n    };\n    return mapping[ticker.toUpperCase()] || ticker.toLowerCase();\n  }\n\n  private isSolanaToken(ticker: string): boolean {\n    const solanaTokens = ['SOL', 'BONK', 'WIF', 'JTO', 'PYTH', 'JUP', 'ORCA', 'RAY', 'MNGO'];\n    return solanaTokens.includes(ticker.toUpperCase());\n  }\n\n  private isStockTicker(ticker: string): boolean {\n    const stockPatterns = /^[A-Z]{1,5}$/;\n    const knownStocks = ['AAPL', 'MSFT', 'GOOGL', 'AMZN', 'META', 'TSLA', 'NVDA', 'AMD', 'INTC', 'IBM'];\n    const knownCrypto = ['BTC', 'ETH', 'SOL', 'BNB', 'XRP', 'ADA', 'DOGE', 'DOT', 'MATIC', 'AVAX'];\n    \n    if (knownStocks.includes(ticker.toUpperCase())) return true;\n    if (knownCrypto.includes(ticker.toUpperCase())) return false;\n    \n    return stockPatterns.test(ticker) && ticker.length <= 4;\n  }\n}\n\nexport const dataIntegration = new DataIntegrationLayer();\n"],"names":[],"mappings":"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"}