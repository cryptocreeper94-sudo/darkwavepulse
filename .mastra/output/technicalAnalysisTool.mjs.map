{"version":3,"file":"technicalAnalysisTool.mjs","sources":["../../src/services/predictionLearningService.ts","../../src/mastra/tools/technicalAnalysisTool.ts"],"sourcesContent":["import { db } from '../db/client.js';\nimport { \n  predictionEvents, \n  predictionOutcomes, \n  predictionFeatures,\n  predictionModelVersions,\n  predictionModelMetrics \n} from '../db/schema.js';\nimport { eq, and, desc, sql, isNotNull, gte, lte } from 'drizzle-orm';\nimport { randomBytes } from 'crypto';\n\ntype TimeHorizon = '1h' | '4h' | '24h' | '7d';\n\ninterface FeatureVector {\n  rsiNormalized: number;\n  macdSignal: number;\n  macdStrength: number;\n  ema9Spread: number;\n  ema21Spread: number;\n  ema50Spread: number;\n  ema200Spread: number;\n  ema9Over21: number;\n  ema50Over200: number;\n  bbPosition: number;\n  bbWidth: number;\n  volumeDeltaNorm: number;\n  spikeScoreNorm: number;\n  volatilityNorm: number;\n  distanceToSupport: number;\n  distanceToResistance: number;\n}\n\ninterface TrainingData {\n  features: number[][];\n  labels: number[];\n  featureNames: string[];\n}\n\ninterface ModelCoefficients {\n  intercept: number;\n  weights: Record<string, number>;\n}\n\ninterface TrainingMetrics {\n  accuracy: number;\n  precision: number;\n  recall: number;\n  f1Score: number;\n  auroc: number;\n}\n\ninterface ModelPrediction {\n  probability: number;\n  confidence: 'HIGH' | 'MEDIUM' | 'LOW';\n  signal: 'BUY' | 'SELL' | 'HOLD';\n  modelVersion: string;\n  isModelBased: boolean;\n}\n\nconst FEATURE_NAMES = [\n  'rsiNormalized', 'macdSignal', 'macdStrength',\n  'ema9Spread', 'ema21Spread', 'ema50Spread', 'ema200Spread',\n  'ema9Over21', 'ema50Over200',\n  'bbPosition', 'bbWidth',\n  'volumeDeltaNorm', 'spikeScoreNorm', 'volatilityNorm',\n  'distanceToSupport', 'distanceToResistance'\n];\n\nconst MIN_TRAINING_SAMPLES = 50;\n\nclass PredictionLearningService {\n  private modelCache: Map<TimeHorizon, { coefficients: ModelCoefficients; version: string }> = new Map();\n\n  async extractFeatures(predictionId: string, horizon: TimeHorizon, priceChangePercent: number, isWin: boolean): Promise<void> {\n    const prediction = await db.select().from(predictionEvents).where(eq(predictionEvents.id, predictionId)).limit(1);\n    \n    if (!prediction.length) {\n      console.log(`[ML] Prediction ${predictionId} not found`);\n      return;\n    }\n\n    const pred = prediction[0];\n    const indicators = JSON.parse(pred.indicators);\n    const price = parseFloat(pred.priceAtPrediction);\n\n    const features = this.normalizeIndicators(indicators, price);\n    \n    const featureId = `feat_${Date.now().toString(36)}_${randomBytes(4).toString('hex')}`;\n    \n    await db.insert(predictionFeatures).values({\n      id: featureId,\n      predictionId,\n      horizon,\n      rsiNormalized: features.rsiNormalized.toFixed(4),\n      macdSignal: features.macdSignal.toFixed(4),\n      macdStrength: features.macdStrength.toFixed(4),\n      ema9Spread: features.ema9Spread.toFixed(4),\n      ema21Spread: features.ema21Spread.toFixed(4),\n      ema50Spread: features.ema50Spread.toFixed(4),\n      ema200Spread: features.ema200Spread.toFixed(4),\n      ema9Over21: features.ema9Over21 > 0,\n      ema50Over200: features.ema50Over200 > 0,\n      bbPosition: features.bbPosition.toFixed(4),\n      bbWidth: features.bbWidth.toFixed(4),\n      volumeDeltaNorm: features.volumeDeltaNorm.toFixed(4),\n      spikeScoreNorm: features.spikeScoreNorm.toFixed(4),\n      volatilityNorm: features.volatilityNorm.toFixed(4),\n      distanceToSupport: features.distanceToSupport.toFixed(4),\n      distanceToResistance: features.distanceToResistance.toFixed(4),\n      priceChangePercent: priceChangePercent.toFixed(4),\n      isWin,\n    });\n\n    console.log(`[ML] Extracted features for prediction ${predictionId} horizon ${horizon}`);\n  }\n\n  private normalizeIndicators(indicators: any, price: number): FeatureVector {\n    const rsi = this.safeNumber(indicators.rsi, 50);\n    \n    const macdHistogram = this.safeNumber(indicators.macd?.histogram, 0);\n    const macdValue = this.safeNumber(indicators.macd?.value, 0);\n    const macdSignalLine = this.safeNumber(indicators.macd?.signal, 0);\n    \n    const ema9 = this.safeNumber(indicators.ema9, price);\n    const ema21 = this.safeNumber(indicators.ema21, price);\n    const ema50 = this.safeNumber(indicators.ema50, price);\n    const ema200 = this.safeNumber(indicators.ema200, price);\n    \n    const bbUpper = this.safeNumber(indicators.bollingerBands?.upper, price * 1.02);\n    const bbLower = this.safeNumber(indicators.bollingerBands?.lower, price * 0.98);\n    const bbMiddle = this.safeNumber(indicators.bollingerBands?.middle, price);\n    \n    const volumeDeltaValue = typeof indicators.volumeDelta === 'object' \n      ? this.safeNumber(indicators.volumeDelta?.delta, 0)\n      : this.safeNumber(indicators.volumeDelta, 0);\n    \n    const spikeScoreValue = typeof indicators.spikeScore === 'object'\n      ? this.safeNumber(indicators.spikeScore?.score, 0)\n      : this.safeNumber(indicators.spikeScore, 0);\n    \n    const volatility = this.safeNumber(indicators.volatility, 0);\n    \n    const support = this.safeNumber(indicators.support, price * 0.95);\n    const resistance = this.safeNumber(indicators.resistance, price * 1.05);\n\n    const bbRange = bbUpper - bbLower;\n    const bbPositionRaw = bbRange > 0 ? (price - bbMiddle) / (bbRange / 2) : 0;\n\n    return {\n      rsiNormalized: this.safeNumber(rsi / 100, 0.5),\n      macdSignal: macdHistogram > 0 ? 1 : macdHistogram < 0 ? -1 : 0,\n      macdStrength: price > 0 ? Math.min(Math.abs(macdValue - macdSignalLine) / price * 100, 1) : 0,\n      ema9Spread: this.clamp((price - ema9) / (price || 1) * 100, -10, 10) / 10,\n      ema21Spread: this.clamp((price - ema21) / (price || 1) * 100, -10, 10) / 10,\n      ema50Spread: this.clamp((price - ema50) / (price || 1) * 100, -20, 20) / 20,\n      ema200Spread: this.clamp((price - ema200) / (price || 1) * 100, -50, 50) / 50,\n      ema9Over21: ema9 > ema21 ? 1 : 0,\n      ema50Over200: ema50 > ema200 ? 1 : 0,\n      bbPosition: this.clamp(bbPositionRaw, -1, 1),\n      bbWidth: bbMiddle > 0 ? Math.min(bbRange / bbMiddle, 0.2) / 0.2 : 0,\n      volumeDeltaNorm: this.clamp(volumeDeltaValue / 100, -1, 1),\n      spikeScoreNorm: Math.min(Math.max(spikeScoreValue / 100, 0), 1),\n      volatilityNorm: Math.min(Math.max(volatility / 10, 0), 1),\n      distanceToSupport: this.clamp((price - support) / (price || 1) * 100, 0, 20) / 20,\n      distanceToResistance: this.clamp((resistance - price) / (price || 1) * 100, 0, 20) / 20,\n    };\n  }\n\n  private safeNumber(value: any, defaultValue: number): number {\n    const num = Number(value);\n    return isNaN(num) ? defaultValue : num;\n  }\n\n  private clamp(value: number, min: number, max: number): number {\n    return Math.max(min, Math.min(max, value));\n  }\n\n  async getTrainingData(horizon: TimeHorizon): Promise<TrainingData> {\n    const features = await db.select()\n      .from(predictionFeatures)\n      .where(and(\n        eq(predictionFeatures.horizon, horizon),\n        isNotNull(predictionFeatures.isWin)\n      ));\n\n    const featureVectors: number[][] = [];\n    const labels: number[] = [];\n\n    for (const f of features) {\n      const vector = [\n        parseFloat(f.rsiNormalized || '0.5'),\n        parseFloat(f.macdSignal || '0'),\n        parseFloat(f.macdStrength || '0'),\n        parseFloat(f.ema9Spread || '0'),\n        parseFloat(f.ema21Spread || '0'),\n        parseFloat(f.ema50Spread || '0'),\n        parseFloat(f.ema200Spread || '0'),\n        f.ema9Over21 ? 1 : 0,\n        f.ema50Over200 ? 1 : 0,\n        parseFloat(f.bbPosition || '0'),\n        parseFloat(f.bbWidth || '0'),\n        parseFloat(f.volumeDeltaNorm || '0'),\n        parseFloat(f.spikeScoreNorm || '0'),\n        parseFloat(f.volatilityNorm || '0'),\n        parseFloat(f.distanceToSupport || '0'),\n        parseFloat(f.distanceToResistance || '0'),\n      ];\n      featureVectors.push(vector);\n      labels.push(f.isWin ? 1 : 0);\n    }\n\n    return { features: featureVectors, labels, featureNames: FEATURE_NAMES };\n  }\n\n  async trainModel(horizon: TimeHorizon): Promise<{ success: boolean; modelId?: string; metrics?: TrainingMetrics; error?: string }> {\n    console.log(`[ML] Starting model training for horizon ${horizon}`);\n    \n    const data = await this.getTrainingData(horizon);\n    \n    if (data.features.length < MIN_TRAINING_SAMPLES) {\n      return { \n        success: false, \n        error: `Insufficient data: ${data.features.length}/${MIN_TRAINING_SAMPLES} samples` \n      };\n    }\n\n    const splitIndex = Math.floor(data.features.length * 0.8);\n    const indices = this.shuffleArray([...Array(data.features.length).keys()]);\n    \n    const trainIndices = indices.slice(0, splitIndex);\n    const valIndices = indices.slice(splitIndex);\n    \n    const trainX = trainIndices.map(i => data.features[i]);\n    const trainY = trainIndices.map(i => data.labels[i]);\n    const valX = valIndices.map(i => data.features[i]);\n    const valY = valIndices.map(i => data.labels[i]);\n\n    const coefficients = this.trainLogisticRegression(trainX, trainY, 0.01, 1000);\n    const metrics = this.evaluateModel(coefficients, valX, valY);\n    \n    const existingModels = await db.select()\n      .from(predictionModelVersions)\n      .where(eq(predictionModelVersions.horizon, horizon))\n      .orderBy(desc(predictionModelVersions.version))\n      .limit(1);\n    \n    const newVersion = existingModels.length > 0 ? existingModels[0].version + 1 : 1;\n    const modelId = `model_${horizon}_v${newVersion}_${randomBytes(4).toString('hex')}`;\n\n    await db.insert(predictionModelVersions).values({\n      id: modelId,\n      modelName: 'logistic_v1',\n      horizon,\n      version: newVersion,\n      coefficients: JSON.stringify(coefficients),\n      featureNames: JSON.stringify(FEATURE_NAMES),\n      trainingSamples: trainX.length,\n      validationSamples: valX.length,\n      trainingDateRange: JSON.stringify({ \n        start: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString(),\n        end: new Date().toISOString()\n      }),\n      accuracy: metrics.accuracy.toFixed(4),\n      precision: metrics.precision.toFixed(4),\n      recall: metrics.recall.toFixed(4),\n      f1Score: metrics.f1Score.toFixed(4),\n      auroc: metrics.auroc.toFixed(4),\n      status: 'validated',\n      isActive: false,\n    });\n\n    console.log(`[ML] Model ${modelId} trained - Accuracy: ${(metrics.accuracy * 100).toFixed(1)}%`);\n\n    if (metrics.accuracy >= 0.55) {\n      await this.activateModel(modelId, horizon);\n    }\n\n    return { success: true, modelId, metrics };\n  }\n\n  private trainLogisticRegression(X: number[][], y: number[], learningRate: number, iterations: number): ModelCoefficients {\n    const numFeatures = X[0].length;\n    let weights = new Array(numFeatures).fill(0);\n    let intercept = 0;\n\n    for (let iter = 0; iter < iterations; iter++) {\n      let interceptGrad = 0;\n      const weightGrads = new Array(numFeatures).fill(0);\n\n      for (let i = 0; i < X.length; i++) {\n        const z = intercept + X[i].reduce((sum, x, j) => sum + x * weights[j], 0);\n        const pred = this.sigmoid(z);\n        const error = pred - y[i];\n\n        interceptGrad += error;\n        for (let j = 0; j < numFeatures; j++) {\n          weightGrads[j] += error * X[i][j];\n        }\n      }\n\n      intercept -= learningRate * (interceptGrad / X.length);\n      for (let j = 0; j < numFeatures; j++) {\n        weights[j] -= learningRate * (weightGrads[j] / X.length);\n      }\n    }\n\n    const weightObj: Record<string, number> = {};\n    FEATURE_NAMES.forEach((name, i) => {\n      weightObj[name] = weights[i];\n    });\n\n    return { intercept, weights: weightObj };\n  }\n\n  private sigmoid(z: number): number {\n    return 1 / (1 + Math.exp(-Math.max(-500, Math.min(500, z))));\n  }\n\n  private evaluateModel(coefficients: ModelCoefficients, X: number[][], y: number[]): TrainingMetrics {\n    let tp = 0, fp = 0, tn = 0, fn = 0;\n    const predictions: number[] = [];\n\n    for (let i = 0; i < X.length; i++) {\n      const prob = this.predictProbability(coefficients, X[i]);\n      predictions.push(prob);\n      const pred = prob >= 0.5 ? 1 : 0;\n      \n      if (pred === 1 && y[i] === 1) tp++;\n      else if (pred === 1 && y[i] === 0) fp++;\n      else if (pred === 0 && y[i] === 0) tn++;\n      else fn++;\n    }\n\n    const accuracy = (tp + tn) / (tp + tn + fp + fn);\n    const precision = tp + fp > 0 ? tp / (tp + fp) : 0;\n    const recall = tp + fn > 0 ? tp / (tp + fn) : 0;\n    const f1Score = precision + recall > 0 ? 2 * (precision * recall) / (precision + recall) : 0;\n    const auroc = this.calculateAUROC(predictions, y);\n\n    return { accuracy, precision, recall, f1Score, auroc };\n  }\n\n  private calculateAUROC(predictions: number[], labels: number[]): number {\n    const pairs = predictions.map((p, i) => ({ pred: p, label: labels[i] }));\n    pairs.sort((a, b) => b.pred - a.pred);\n\n    let auc = 0;\n    let tp = 0;\n    let fp = 0;\n    const totalPos = labels.filter(l => l === 1).length;\n    const totalNeg = labels.length - totalPos;\n\n    if (totalPos === 0 || totalNeg === 0) return 0.5;\n\n    for (const pair of pairs) {\n      if (pair.label === 1) {\n        tp++;\n      } else {\n        auc += tp;\n        fp++;\n      }\n    }\n\n    return auc / (totalPos * totalNeg);\n  }\n\n  private predictProbability(coefficients: ModelCoefficients, features: number[]): number {\n    let z = coefficients.intercept;\n    FEATURE_NAMES.forEach((name, i) => {\n      z += features[i] * (coefficients.weights[name] || 0);\n    });\n    return this.sigmoid(z);\n  }\n\n  async activateModel(modelId: string, horizon: TimeHorizon): Promise<void> {\n    await db.update(predictionModelVersions)\n      .set({ isActive: false })\n      .where(and(\n        eq(predictionModelVersions.horizon, horizon),\n        eq(predictionModelVersions.isActive, true)\n      ));\n\n    await db.update(predictionModelVersions)\n      .set({ isActive: true, status: 'active', activatedAt: new Date() })\n      .where(eq(predictionModelVersions.id, modelId));\n\n    this.modelCache.delete(horizon);\n    console.log(`[ML] Activated model ${modelId} for horizon ${horizon}`);\n  }\n\n  async getActiveModel(horizon: TimeHorizon): Promise<{ coefficients: ModelCoefficients; version: string } | null> {\n    if (this.modelCache.has(horizon)) {\n      return this.modelCache.get(horizon)!;\n    }\n\n    const model = await db.select()\n      .from(predictionModelVersions)\n      .where(and(\n        eq(predictionModelVersions.horizon, horizon),\n        eq(predictionModelVersions.isActive, true)\n      ))\n      .limit(1);\n\n    if (!model.length) return null;\n\n    const cached = {\n      coefficients: JSON.parse(model[0].coefficients) as ModelCoefficients,\n      version: model[0].id,\n    };\n    this.modelCache.set(horizon, cached);\n    return cached;\n  }\n\n  async predictWithModel(indicators: any, price: number, horizon: TimeHorizon = '24h'): Promise<ModelPrediction> {\n    const model = await this.getActiveModel(horizon);\n    \n    if (!model) {\n      return {\n        probability: 0.5,\n        confidence: 'LOW',\n        signal: 'HOLD',\n        modelVersion: 'none',\n        isModelBased: false,\n      };\n    }\n\n    const features = this.normalizeIndicators(indicators, price);\n    const featureVector = FEATURE_NAMES.map(name => (features as any)[name]);\n    const probability = this.predictProbability(model.coefficients, featureVector);\n\n    let signal: 'BUY' | 'SELL' | 'HOLD';\n    let confidence: 'HIGH' | 'MEDIUM' | 'LOW';\n\n    if (probability >= 0.7) {\n      signal = 'BUY';\n      confidence = 'HIGH';\n    } else if (probability >= 0.6) {\n      signal = 'BUY';\n      confidence = 'MEDIUM';\n    } else if (probability <= 0.3) {\n      signal = 'SELL';\n      confidence = 'HIGH';\n    } else if (probability <= 0.4) {\n      signal = 'SELL';\n      confidence = 'MEDIUM';\n    } else {\n      signal = 'HOLD';\n      confidence = probability >= 0.45 && probability <= 0.55 ? 'MEDIUM' : 'LOW';\n    }\n\n    return {\n      probability,\n      confidence,\n      signal,\n      modelVersion: model.version,\n      isModelBased: true,\n    };\n  }\n\n  async getModelStatus(): Promise<{\n    horizons: Record<TimeHorizon, {\n      hasActiveModel: boolean;\n      modelVersion?: string;\n      accuracy?: number;\n      trainingSamples?: number;\n      trainedAt?: string;\n    }>;\n    totalFeatures: number;\n    readyToTrain: Record<TimeHorizon, boolean>;\n  }> {\n    const horizons: TimeHorizon[] = ['1h', '4h', '24h', '7d'];\n    const result: any = { horizons: {}, totalFeatures: 0, readyToTrain: {} };\n\n    for (const horizon of horizons) {\n      const model = await db.select()\n        .from(predictionModelVersions)\n        .where(and(\n          eq(predictionModelVersions.horizon, horizon),\n          eq(predictionModelVersions.isActive, true)\n        ))\n        .limit(1);\n\n      const featureCount = await db.select({ count: sql<number>`count(*)` })\n        .from(predictionFeatures)\n        .where(and(\n          eq(predictionFeatures.horizon, horizon),\n          isNotNull(predictionFeatures.isWin)\n        ));\n\n      const count = Number(featureCount[0]?.count || 0);\n      result.totalFeatures += count;\n      result.readyToTrain[horizon] = count >= MIN_TRAINING_SAMPLES;\n\n      if (model.length) {\n        result.horizons[horizon] = {\n          hasActiveModel: true,\n          modelVersion: model[0].id,\n          accuracy: parseFloat(model[0].accuracy),\n          trainingSamples: model[0].trainingSamples,\n          trainedAt: model[0].trainedAt?.toISOString(),\n        };\n      } else {\n        result.horizons[horizon] = {\n          hasActiveModel: false,\n        };\n      }\n    }\n\n    return result;\n  }\n\n  async trainAllHorizons(): Promise<Record<TimeHorizon, { success: boolean; error?: string; accuracy?: number }>> {\n    const horizons: TimeHorizon[] = ['1h', '4h', '24h', '7d'];\n    const results: any = {};\n\n    for (const horizon of horizons) {\n      const result = await this.trainModel(horizon);\n      results[horizon] = {\n        success: result.success,\n        error: result.error,\n        accuracy: result.metrics?.accuracy,\n      };\n    }\n\n    return results;\n  }\n\n  private shuffleArray<T>(array: T[]): T[] {\n    const shuffled = [...array];\n    for (let i = shuffled.length - 1; i > 0; i--) {\n      const j = Math.floor(Math.random() * (i + 1));\n      [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];\n    }\n    return shuffled;\n  }\n\n  async detectDrift(horizon: TimeHorizon, windowDays: number = 7): Promise<{\n    hasDrift: boolean;\n    severity: 'LOW' | 'MEDIUM' | 'HIGH' | 'CRITICAL';\n    metrics: {\n      recentAccuracy: number;\n      historicalAccuracy: number;\n      accuracyDrop: number;\n      recentSamples: number;\n      historicalSamples: number;\n    };\n    recommendation: string;\n  }> {\n    const now = new Date();\n    const windowStart = new Date(now.getTime() - windowDays * 24 * 60 * 60 * 1000);\n    const historicalStart = new Date(windowStart.getTime() - windowDays * 24 * 60 * 60 * 1000);\n\n    const recentFeatures = await db.select()\n      .from(predictionFeatures)\n      .where(and(\n        eq(predictionFeatures.horizon, horizon),\n        isNotNull(predictionFeatures.isWin),\n        gte(predictionFeatures.createdAt, windowStart)\n      ));\n\n    const historicalFeatures = await db.select()\n      .from(predictionFeatures)\n      .where(and(\n        eq(predictionFeatures.horizon, horizon),\n        isNotNull(predictionFeatures.isWin),\n        gte(predictionFeatures.createdAt, historicalStart),\n        lte(predictionFeatures.createdAt, windowStart)\n      ));\n\n    const recentWins = recentFeatures.filter(f => f.isWin).length;\n    const recentTotal = recentFeatures.length;\n    const historicalWins = historicalFeatures.filter(f => f.isWin).length;\n    const historicalTotal = historicalFeatures.length;\n\n    const recentAccuracy = recentTotal > 0 ? (recentWins / recentTotal) * 100 : 50;\n    const historicalAccuracy = historicalTotal > 0 ? (historicalWins / historicalTotal) * 100 : 50;\n    const accuracyDrop = historicalAccuracy - recentAccuracy;\n\n    let severity: 'LOW' | 'MEDIUM' | 'HIGH' | 'CRITICAL' = 'LOW';\n    let hasDrift = false;\n    let recommendation = 'Model performing within expected parameters';\n\n    if (accuracyDrop > 5 && recentTotal >= 10) {\n      hasDrift = true;\n      if (accuracyDrop > 20) {\n        severity = 'CRITICAL';\n        recommendation = 'Immediate retraining required - significant performance degradation detected';\n      } else if (accuracyDrop > 15) {\n        severity = 'HIGH';\n        recommendation = 'Schedule retraining soon - notable performance decline';\n      } else if (accuracyDrop > 10) {\n        severity = 'MEDIUM';\n        recommendation = 'Monitor closely - moderate performance decline observed';\n      } else {\n        severity = 'LOW';\n        recommendation = 'Minor drift detected - continue monitoring';\n      }\n    }\n\n    if (recentAccuracy < 45 && recentTotal >= 10) {\n      hasDrift = true;\n      severity = severity === 'CRITICAL' ? 'CRITICAL' : 'HIGH';\n      recommendation = 'Model accuracy below threshold - retraining recommended';\n    }\n\n    return {\n      hasDrift,\n      severity,\n      metrics: {\n        recentAccuracy: Math.round(recentAccuracy * 10) / 10,\n        historicalAccuracy: Math.round(historicalAccuracy * 10) / 10,\n        accuracyDrop: Math.round(accuracyDrop * 10) / 10,\n        recentSamples: recentTotal,\n        historicalSamples: historicalTotal,\n      },\n      recommendation,\n    };\n  }\n\n  async checkAllHorizonsDrift(windowDays: number = 7): Promise<{\n    hasAnyDrift: boolean;\n    horizonStatus: Record<TimeHorizon, {\n      hasDrift: boolean;\n      severity: string;\n      recentAccuracy: number;\n      recommendation: string;\n    }>;\n    overallRecommendation: string;\n  }> {\n    const horizons: TimeHorizon[] = ['1h', '4h', '24h', '7d'];\n    const results: any = { hasAnyDrift: false, horizonStatus: {}, overallRecommendation: '' };\n    let highestSeverity = 'LOW';\n\n    for (const horizon of horizons) {\n      const drift = await this.detectDrift(horizon, windowDays);\n      results.horizonStatus[horizon] = {\n        hasDrift: drift.hasDrift,\n        severity: drift.severity,\n        recentAccuracy: drift.metrics.recentAccuracy,\n        recommendation: drift.recommendation,\n      };\n\n      if (drift.hasDrift) {\n        results.hasAnyDrift = true;\n        if (drift.severity === 'CRITICAL' || (drift.severity === 'HIGH' && highestSeverity !== 'CRITICAL')) {\n          highestSeverity = drift.severity;\n        }\n      }\n    }\n\n    if (highestSeverity === 'CRITICAL') {\n      results.overallRecommendation = 'Immediate action needed: Critical drift detected in one or more models';\n    } else if (highestSeverity === 'HIGH') {\n      results.overallRecommendation = 'Schedule retraining: High drift detected';\n    } else if (results.hasAnyDrift) {\n      results.overallRecommendation = 'Monitor: Minor drift detected in some models';\n    } else {\n      results.overallRecommendation = 'All models performing within expected parameters';\n    }\n\n    return results;\n  }\n}\n\nexport const predictionLearningService = new PredictionLearningService();\n","import { createTool } from \"@mastra/core/tools\";\nimport { z } from \"zod\";\nimport { RSI, MACD, EMA, SMA, BollingerBands } from \"technicalindicators\";\nimport { checkSubscriptionLimit } from \"../middleware/subscriptionCheck.js\";\nimport { predictionLearningService } from \"../../services/predictionLearningService.js\";\n\n/**\n * Technical Analysis Tool - Calculates all technical indicators and generates buy/sell signals\n * Analyzes: RSI, MACD, EMAs, SMAs, Bollinger Bands, Support/Resistance, Volume\n */\n\nexport const technicalAnalysisTool = createTool({\n  id: \"technical-analysis-tool\",\n  description: \"Performs comprehensive technical analysis on price data. Calculates RSI, MACD, moving averages, Bollinger Bands, support/resistance levels, and generates buy/sell signals.\",\n\n  inputSchema: z.object({\n    ticker: z.string().describe(\"Ticker symbol\"),\n    currentPrice: z.number().describe(\"Current market price\"),\n    priceChange24h: z.number().describe(\"24h price change in dollars\"),\n    priceChangePercent24h: z.number().describe(\"24h price change percentage\"),\n    volume24h: z.number().optional().describe(\"24h trading volume\"),\n    prices: z.array(z.object({\n      timestamp: z.number(),\n      open: z.number(),\n      high: z.number(),\n      low: z.number(),\n      close: z.number(),\n      volume: z.number(),\n    })).describe(\"Historical OHLCV data\"),\n  }),\n\n  outputSchema: z.object({\n    ticker: z.string(),\n    currentPrice: z.number(),\n    priceChange24h: z.number(),\n    priceChangePercent24h: z.number(),\n    rsi: z.number(),\n    macd: z.object({\n      value: z.number(),\n      signal: z.number(),\n      histogram: z.number(),\n    }),\n    ema9: z.number(),\n    ema21: z.number(),\n    ema50: z.number(),\n    ema200: z.number(),\n    sma50: z.number(),\n    sma200: z.number(),\n    bollingerBands: z.object({\n      upper: z.number(),\n      middle: z.number(),\n      lower: z.number(),\n      bandwidth: z.number(),\n    }),\n    support: z.number(),\n    resistance: z.number(),\n    volume: z.object({\n      current: z.number(),\n      average: z.number(),\n      changePercent: z.number(),\n    }),\n    volumeDelta: z.object({\n      buyVolume: z.number(),\n      sellVolume: z.number(),\n      delta: z.number(),\n      buySellRatio: z.number(),\n    }),\n    spikeScore: z.object({\n      score: z.number(),\n      signal: z.enum(['SPIKE_SIGNAL', 'WATCHLIST', 'NO_SIGNAL']),\n      prediction: z.string(),\n    }),\n    volatility: z.number(),\n    patternDuration: z.object({\n      estimate: z.string(),\n      confidence: z.string(),\n      type: z.string(),\n    }),\n    signals: z.array(z.string()),\n    recommendation: z.enum(['BUY', 'SELL', 'HOLD', 'STRONG_BUY', 'STRONG_SELL']),\n    signalCount: z.object({\n      bullish: z.number(),\n      bearish: z.number(),\n    }),\n  }),\n\n  execute: async ({ context, mastra, runtimeContext }) => {\n    const logger = mastra?.getLogger();\n    logger?.info('üîß [TechnicalAnalysisTool] Starting analysis', { ticker: context.ticker });\n\n    // Extract userId from runtimeContext\n    const userId = (runtimeContext as any)?.resourceId || 'unknown';\n    \n    // Check subscription limit for searches (technical analysis counts as search)\n    const limitCheck = await checkSubscriptionLimit(userId, 'search');\n    logger?.info('üîê [TechnicalAnalysisTool] Subscription check result', { userId, allowed: limitCheck.allowed, isPremium: limitCheck.isPremium });\n    \n    if (!limitCheck.allowed) {\n      logger?.warn('‚ö†Ô∏è [TechnicalAnalysisTool] Usage limit exceeded', { userId, message: limitCheck.message });\n      throw new Error(limitCheck.message || 'Daily search limit reached. Upgrade to Premium for unlimited access!');\n    }\n\n    const closePrices = context.prices.map(p => p.close);\n    const highPrices = context.prices.map(p => p.high);\n    const lowPrices = context.prices.map(p => p.low);\n    const volumes = context.prices.map(p => p.volume);\n\n    logger?.info('üìä [TechnicalAnalysisTool] Calculating indicators', { dataPoints: closePrices.length });\n\n    // Calculate RSI (14 period)\n    const rsiValues = RSI.calculate({ values: closePrices, period: 14 });\n    const currentRSI = rsiValues[rsiValues.length - 1] || 50;\n\n    // Calculate MACD (12, 26, 9)\n    const macdValues = MACD.calculate({\n      values: closePrices,\n      fastPeriod: 12,\n      slowPeriod: 26,\n      signalPeriod: 9,\n      SimpleMAOscillator: false,\n      SimpleMASignal: false,\n    });\n    const currentMACD = macdValues[macdValues.length - 1] || { MACD: 0, signal: 0, histogram: 0 };\n\n    // Calculate EMAs (9, 21, 50, 200)\n    const ema9Values = EMA.calculate({ values: closePrices, period: 9 });\n    const ema21Values = EMA.calculate({ values: closePrices, period: 21 });\n    const ema50Values = EMA.calculate({ values: closePrices, period: 50 });\n    const ema200Values = EMA.calculate({ values: closePrices, period: 200 });\n    const currentEMA9 = ema9Values[ema9Values.length - 1] || context.currentPrice;\n    const currentEMA21 = ema21Values[ema21Values.length - 1] || context.currentPrice;\n    const currentEMA50 = ema50Values[ema50Values.length - 1] || context.currentPrice;\n    const currentEMA200 = ema200Values[ema200Values.length - 1] || context.currentPrice;\n\n    // Calculate SMAs\n    const sma50Values = SMA.calculate({ values: closePrices, period: 50 });\n    const sma200Values = SMA.calculate({ values: closePrices, period: 200 });\n    const currentSMA50 = sma50Values[sma50Values.length - 1] || context.currentPrice;\n    const currentSMA200 = sma200Values[sma200Values.length - 1] || context.currentPrice;\n\n    // Calculate Bollinger Bands\n    const bbValues = BollingerBands.calculate({\n      values: closePrices,\n      period: 20,\n      stdDev: 2,\n    });\n    const currentBB = bbValues[bbValues.length - 1] || { upper: 0, middle: 0, lower: 0 };\n    const bandwidth = ((currentBB.upper - currentBB.lower) / currentBB.middle) * 100;\n\n    // Calculate dynamic support and resistance (recent 30-day window)\n    const recentPrices = context.prices.slice(-30);\n    const support = calculateDynamicSupport(recentPrices, context.currentPrice);\n    const resistance = calculateDynamicResistance(recentPrices, context.currentPrice);\n\n    // Calculate volume metrics\n    const avgVolume = volumes.slice(-20).reduce((a, b) => a + b, 0) / 20;\n    const currentVolume = context.volume24h || volumes[volumes.length - 1] || 0;\n    const volumeChangePercent = ((currentVolume - avgVolume) / avgVolume) * 100;\n\n    // Calculate volatility (standard deviation of recent returns)\n    const volatility = calculateVolatility(closePrices.slice(-30));\n\n    // Calculate Volume Delta (estimate buy vs sell pressure)\n    const volumeDelta = calculateVolumeDelta(\n      context.prices.slice(-20),\n      currentVolume,\n      context.priceChangePercent24h\n    );\n\n    // Calculate Spike Score (predictive score 0-100)\n    const spikeScore = calculateSpikeScore({\n      volumeDelta: volumeDelta.delta,\n      rsi: currentRSI,\n      momentum: context.priceChangePercent24h,\n      volumeChange: volumeChangePercent,\n      trendStrength: Math.abs(currentEMA50 - currentEMA200) / context.currentPrice * 100,\n    });\n\n    // Calculate pattern duration estimate\n    const patternDuration = estimatePatternDuration(\n      context.prices,\n      currentRSI,\n      currentMACD,\n      volumeChangePercent,\n      context.currentPrice,\n      currentEMA50,\n      currentEMA200\n    );\n\n    logger?.info('üìù [TechnicalAnalysisTool] Generating signals');\n\n    // Generate signals\n    const signals: string[] = [];\n    let bullishCount = 0;\n    let bearishCount = 0;\n\n    // RSI signals\n    if (currentRSI < 30) {\n      signals.push('RSI oversold (bullish)');\n      bullishCount++;\n    } else if (currentRSI > 70) {\n      signals.push('RSI overbought (bearish)');\n      bearishCount++;\n    }\n\n    // MACD signals\n    if (currentMACD.histogram && currentMACD.MACD && currentMACD.signal) {\n      if (currentMACD.histogram > 0 && currentMACD.MACD > currentMACD.signal) {\n        signals.push('MACD bullish crossover');\n        bullishCount++;\n      } else if (currentMACD.histogram < 0 && currentMACD.MACD < currentMACD.signal) {\n        signals.push('MACD bearish crossover');\n        bearishCount++;\n      }\n    }\n\n    // Moving average signals\n    if (context.currentPrice > currentEMA50 && currentEMA50 > currentEMA200) {\n      signals.push('Golden cross pattern (bullish)');\n      bullishCount++;\n    } else if (context.currentPrice < currentEMA50 && currentEMA50 < currentEMA200) {\n      signals.push('Death cross pattern (bearish)');\n      bearishCount++;\n    }\n\n    // Price vs MA signals\n    if (context.currentPrice > currentSMA50) {\n      bullishCount++;\n    } else {\n      bearishCount++;\n    }\n\n    if (context.currentPrice > currentSMA200) {\n      bullishCount++;\n    } else {\n      bearishCount++;\n    }\n\n    // Bollinger Band signals\n    if (context.currentPrice < currentBB.lower) {\n      signals.push('Price below lower Bollinger Band (bullish)');\n      bullishCount++;\n    } else if (context.currentPrice > currentBB.upper) {\n      signals.push('Price above upper Bollinger Band (bearish)');\n      bearishCount++;\n    }\n\n    // Support/Resistance signals\n    const distanceToSupport = ((context.currentPrice - support) / support) * 100;\n    const distanceToResistance = ((resistance - context.currentPrice) / context.currentPrice) * 100;\n\n    if (distanceToSupport < 2) {\n      signals.push('Near support level (potential bounce)');\n      bullishCount++;\n    }\n\n    if (distanceToResistance < 2) {\n      signals.push('Near resistance level (potential rejection)');\n      bearishCount++;\n    }\n\n    // Volume signals\n    if (volumeChangePercent > 50 && context.priceChangePercent24h > 0) {\n      signals.push('High volume breakout (bullish)');\n      bullishCount++;\n    } else if (volumeChangePercent > 50 && context.priceChangePercent24h < 0) {\n      signals.push('High volume selloff (bearish)');\n      bearishCount++;\n    }\n\n    // Determine recommendation - blend rule-based with ML model when available\n    let recommendation: 'BUY' | 'SELL' | 'HOLD' | 'STRONG_BUY' | 'STRONG_SELL';\n    const netSignal = bullishCount - bearishCount;\n\n    // Rule-based recommendation\n    let ruleBasedRec: 'BUY' | 'SELL' | 'HOLD' | 'STRONG_BUY' | 'STRONG_SELL';\n    if (netSignal >= 3) {\n      ruleBasedRec = 'STRONG_BUY';\n    } else if (netSignal >= 1) {\n      ruleBasedRec = 'BUY';\n    } else if (netSignal <= -3) {\n      ruleBasedRec = 'STRONG_SELL';\n    } else if (netSignal <= -1) {\n      ruleBasedRec = 'SELL';\n    } else {\n      ruleBasedRec = 'HOLD';\n    }\n\n    // Try ML model prediction (24h horizon by default)\n    let isModelBased = false;\n    let modelProbability = 0.5;\n    try {\n      const indicators = {\n        rsi: currentRSI,\n        macd: { macdLine: currentMACD.MACD, signalLine: currentMACD.signal, histogram: currentMACD.histogram },\n        ema9: currentEMA9,\n        ema21: currentEMA21,\n        ema50: currentEMA50,\n        ema200: currentEMA200,\n        bollingerBands: { upper: currentBB.upper, middle: currentBB.middle, lower: currentBB.lower },\n        support,\n        resistance,\n        volumeDelta: volumeDelta.delta,\n        spikeScore: spikeScore.score,\n        volatility,\n      };\n      \n      const mlPrediction = await predictionLearningService.predictWithModel(indicators, context.currentPrice, '24h');\n      \n      if (mlPrediction.isModelBased) {\n        isModelBased = true;\n        modelProbability = mlPrediction.probability;\n        \n        // Blend ML with rule-based: ML confidence affects final recommendation\n        // If both agree, strengthen the signal; if they disagree, use ML confidence to moderate\n        const mlSignal = mlPrediction.signal;\n        const mlConfidence = mlPrediction.confidence;\n        \n        if (mlConfidence === 'HIGH') {\n          // High confidence ML - weight ML prediction more heavily\n          if (mlSignal === 'BUY' && (ruleBasedRec === 'BUY' || ruleBasedRec === 'STRONG_BUY')) {\n            recommendation = modelProbability >= 0.75 ? 'STRONG_BUY' : 'BUY';\n            signals.push(`ML model: ${(modelProbability * 100).toFixed(0)}% bullish probability (HIGH confidence)`);\n          } else if (mlSignal === 'SELL' && (ruleBasedRec === 'SELL' || ruleBasedRec === 'STRONG_SELL')) {\n            recommendation = modelProbability <= 0.25 ? 'STRONG_SELL' : 'SELL';\n            signals.push(`ML model: ${((1 - modelProbability) * 100).toFixed(0)}% bearish probability (HIGH confidence)`);\n          } else if (mlSignal !== ruleBasedRec && mlConfidence === 'HIGH') {\n            // ML disagrees with high confidence - trust ML more\n            recommendation = mlSignal;\n            signals.push(`ML model override: ${mlSignal} (${(mlPrediction.probability * 100).toFixed(0)}% probability)`);\n          } else {\n            recommendation = ruleBasedRec;\n          }\n        } else if (mlConfidence === 'MEDIUM') {\n          // Medium confidence - blend signals\n          if (mlSignal === ruleBasedRec || (mlSignal === 'BUY' && ruleBasedRec === 'STRONG_BUY') || (mlSignal === 'SELL' && ruleBasedRec === 'STRONG_SELL')) {\n            recommendation = ruleBasedRec;\n            signals.push(`ML model confirms: ${(modelProbability * 100).toFixed(0)}% probability`);\n          } else {\n            // Disagreement with medium confidence - stay cautious\n            recommendation = 'HOLD';\n            signals.push(`ML model uncertain: ${(modelProbability * 100).toFixed(0)}% probability vs rule-based ${ruleBasedRec}`);\n          }\n        } else {\n          // Low confidence ML - use rule-based\n          recommendation = ruleBasedRec;\n        }\n        \n        logger?.info('üß† [TechnicalAnalysisTool] ML prediction used', { \n          mlSignal, \n          mlConfidence, \n          probability: modelProbability,\n          ruleBasedRec,\n          finalRec: recommendation \n        });\n      } else {\n        recommendation = ruleBasedRec;\n      }\n    } catch (mlError) {\n      // ML prediction failed - fall back to rule-based\n      logger?.warn('‚ö†Ô∏è [TechnicalAnalysisTool] ML prediction failed, using rule-based', { error: mlError });\n      recommendation = ruleBasedRec;\n    }\n\n    logger?.info('‚úÖ [TechnicalAnalysisTool] Analysis complete', { \n      ticker: context.ticker,\n      recommendation,\n      isModelBased,\n      signals: signals.length \n    });\n\n    return {\n      ticker: context.ticker,\n      currentPrice: context.currentPrice,\n      priceChange24h: context.priceChange24h,\n      priceChangePercent24h: context.priceChangePercent24h,\n      rsi: parseFloat(currentRSI.toFixed(1)),\n      macd: {\n        value: parseFloat((currentMACD.MACD || 0).toFixed(2)),\n        signal: parseFloat((currentMACD.signal || 0).toFixed(2)),\n        histogram: parseFloat((currentMACD.histogram || 0).toFixed(2)),\n      },\n      ema9: parseFloat(currentEMA9.toFixed(2)),\n      ema21: parseFloat(currentEMA21.toFixed(2)),\n      ema50: parseFloat(currentEMA50.toFixed(2)),\n      ema200: parseFloat(currentEMA200.toFixed(2)),\n      sma50: parseFloat(currentSMA50.toFixed(2)),\n      sma200: parseFloat(currentSMA200.toFixed(2)),\n      bollingerBands: {\n        upper: parseFloat(currentBB.upper.toFixed(2)),\n        middle: parseFloat(currentBB.middle.toFixed(2)),\n        lower: parseFloat(currentBB.lower.toFixed(2)),\n        bandwidth: parseFloat(bandwidth.toFixed(2)),\n      },\n      support: parseFloat(support.toFixed(2)),\n      resistance: parseFloat(resistance.toFixed(2)),\n      volume: {\n        current: parseFloat(currentVolume.toFixed(2)),\n        average: parseFloat(avgVolume.toFixed(2)),\n        changePercent: parseFloat(volumeChangePercent.toFixed(1)),\n      },\n      volumeDelta: {\n        buyVolume: parseFloat(volumeDelta.buyVolume.toFixed(2)),\n        sellVolume: parseFloat(volumeDelta.sellVolume.toFixed(2)),\n        delta: parseFloat(volumeDelta.delta.toFixed(2)),\n        buySellRatio: parseFloat(volumeDelta.buySellRatio.toFixed(2)),\n      },\n      spikeScore: {\n        score: parseFloat(spikeScore.score.toFixed(1)),\n        signal: spikeScore.signal,\n        prediction: spikeScore.prediction,\n      },\n      volatility: parseFloat(volatility.toFixed(1)),\n      patternDuration,\n      signals,\n      recommendation,\n      signalCount: {\n        bullish: bullishCount,\n        bearish: bearishCount,\n      },\n    };\n  },\n});\n\n// Helper functions\n\nfunction calculateDynamicSupport(recentPrices: any[], currentPrice: number): number {\n  const lows = recentPrices.map(p => p.low);\n  const sortedLows = [...lows].sort((a, b) => a - b);\n  \n  // Find support levels below current price\n  const belowCurrent = sortedLows.filter(low => low < currentPrice);\n  \n  if (belowCurrent.length === 0) return sortedLows[0];\n  \n  // Return the highest low below current price (nearest support)\n  return belowCurrent[belowCurrent.length - 1];\n}\n\nfunction calculateDynamicResistance(recentPrices: any[], currentPrice: number): number {\n  const highs = recentPrices.map(p => p.high);\n  const sortedHighs = [...highs].sort((a, b) => b - a);\n  \n  // Find resistance levels above current price\n  const aboveCurrent = sortedHighs.filter(high => high > currentPrice);\n  \n  if (aboveCurrent.length === 0) return sortedHighs[0];\n  \n  // Return the lowest high above current price (nearest resistance)\n  return aboveCurrent[aboveCurrent.length - 1];\n}\n\nfunction calculateVolatility(prices: number[]): number {\n  const returns = [];\n  for (let i = 1; i < prices.length; i++) {\n    returns.push((prices[i] - prices[i - 1]) / prices[i - 1]);\n  }\n  \n  const mean = returns.reduce((a, b) => a + b, 0) / returns.length;\n  const variance = returns.reduce((sum, r) => sum + Math.pow(r - mean, 2), 0) / returns.length;\n  const stdDev = Math.sqrt(variance);\n  \n  return stdDev * 100; // Convert to percentage\n}\n\nfunction estimatePatternDuration(\n  prices: any[],\n  currentRSI: number,\n  currentMACD: any,\n  volumeChange: number,\n  currentPrice: number,\n  ema50: number,\n  ema200: number\n): { estimate: string; confidence: string; type: string } {\n  // Analyze historical patterns to estimate duration of current trend\n  \n  const closePrices = prices.map(p => p.close);\n  let patternType = 'consolidation';\n  let estimatedDays = 0;\n  let confidence = 'low';\n  \n  // RSI-based duration analysis\n  if (currentRSI < 30) {\n    // Oversold - analyze past oversold recoveries\n    const oversoldDurations = analyzeOversoldRecoveries(closePrices, prices);\n    estimatedDays = oversoldDurations.avgDuration;\n    confidence = oversoldDurations.confidence;\n    patternType = 'potential rally from oversold';\n  } else if (currentRSI > 70) {\n    // Overbought - analyze past overbought corrections\n    const overboughtDurations = analyzeOverboughtCorrections(closePrices, prices);\n    estimatedDays = overboughtDurations.avgDuration;\n    confidence = overboughtDurations.confidence;\n    patternType = 'potential correction from overbought';\n  }\n  \n  // MACD momentum duration\n  else if (currentMACD.histogram && Math.abs(currentMACD.histogram) > 0) {\n    const macdDurations = analyzeMACDMomentum(closePrices, prices);\n    estimatedDays = macdDurations.avgDuration;\n    confidence = macdDurations.confidence;\n    if (currentMACD.histogram > 0) {\n      patternType = 'bullish momentum continuation';\n    } else {\n      patternType = 'bearish momentum continuation';\n    }\n  }\n  \n  // Trend-based duration (EMA crossovers)\n  else if (currentPrice > ema50 && ema50 > ema200) {\n    const trendDurations = analyzeUptrends(closePrices, prices);\n    estimatedDays = trendDurations.avgDuration;\n    confidence = trendDurations.confidence;\n    patternType = 'uptrend continuation';\n  } else if (currentPrice < ema50 && ema50 < ema200) {\n    const trendDurations = analyzeDowntrends(closePrices, prices);\n    estimatedDays = trendDurations.avgDuration;\n    confidence = trendDurations.confidence;\n    patternType = 'downtrend continuation';\n  }\n  \n  // Volume spike patterns\n  else if (volumeChange > 50) {\n    estimatedDays = 5; // Volume spikes typically precede 3-7 day moves\n    confidence = 'medium';\n    patternType = 'volume breakout pattern';\n  }\n  \n  // Default consolidation\n  else {\n    estimatedDays = 7;\n    confidence = 'low';\n    patternType = 'consolidation/range-bound';\n  }\n  \n  // Format estimate as time range\n  let estimate = '';\n  if (estimatedDays < 2) {\n    estimate = '1-2 days';\n  } else if (estimatedDays < 7) {\n    estimate = `${Math.floor(estimatedDays)}-${Math.ceil(estimatedDays + 2)} days`;\n  } else if (estimatedDays < 14) {\n    estimate = '1-2 weeks';\n  } else if (estimatedDays < 30) {\n    estimate = '2-4 weeks';\n  } else {\n    estimate = '1-2 months';\n  }\n  \n  return {\n    estimate,\n    confidence,\n    type: patternType,\n  };\n}\n\nfunction analyzeOversoldRecoveries(closePrices: number[], prices: any[]): { avgDuration: number; confidence: string } {\n  // Calculate RSI for all data points\n  const rsiValues = RSI.calculate({ values: closePrices, period: 14 });\n  \n  const recoveries: number[] = [];\n  let inOversold = false;\n  let oversoldStart = 0;\n  \n  for (let i = 0; i < rsiValues.length; i++) {\n    if (rsiValues[i] < 30 && !inOversold) {\n      inOversold = true;\n      oversoldStart = i;\n    } else if (rsiValues[i] >= 50 && inOversold) {\n      // Recovery complete\n      const duration = i - oversoldStart;\n      if (duration > 0 && duration < 60) { // Filter outliers\n        recoveries.push(duration);\n      }\n      inOversold = false;\n    }\n  }\n  \n  if (recoveries.length >= 3) {\n    const avg = recoveries.reduce((a, b) => a + b, 0) / recoveries.length;\n    return { avgDuration: Math.round(avg), confidence: 'high' };\n  } else if (recoveries.length > 0) {\n    const avg = recoveries.reduce((a, b) => a + b, 0) / recoveries.length;\n    return { avgDuration: Math.round(avg), confidence: 'medium' };\n  }\n  \n  return { avgDuration: 5, confidence: 'low' }; // Default estimate\n}\n\nfunction analyzeOverboughtCorrections(closePrices: number[], prices: any[]): { avgDuration: number; confidence: string } {\n  const rsiValues = RSI.calculate({ values: closePrices, period: 14 });\n  \n  const corrections: number[] = [];\n  let inOverbought = false;\n  let overboughtStart = 0;\n  \n  for (let i = 0; i < rsiValues.length; i++) {\n    if (rsiValues[i] > 70 && !inOverbought) {\n      inOverbought = true;\n      overboughtStart = i;\n    } else if (rsiValues[i] <= 50 && inOverbought) {\n      const duration = i - overboughtStart;\n      if (duration > 0 && duration < 60) {\n        corrections.push(duration);\n      }\n      inOverbought = false;\n    }\n  }\n  \n  if (corrections.length >= 3) {\n    const avg = corrections.reduce((a, b) => a + b, 0) / corrections.length;\n    return { avgDuration: Math.round(avg), confidence: 'high' };\n  } else if (corrections.length > 0) {\n    const avg = corrections.reduce((a, b) => a + b, 0) / corrections.length;\n    return { avgDuration: Math.round(avg), confidence: 'medium' };\n  }\n  \n  return { avgDuration: 7, confidence: 'low' };\n}\n\nfunction analyzeMACDMomentum(closePrices: number[], prices: any[]): { avgDuration: number; confidence: string } {\n  const macdValues = MACD.calculate({\n    values: closePrices,\n    fastPeriod: 12,\n    slowPeriod: 26,\n    signalPeriod: 9,\n    SimpleMAOscillator: false,\n    SimpleMASignal: false,\n  });\n  \n  const momentumPeriods: number[] = [];\n  let currentSign = 0;\n  let periodStart = 0;\n  \n  for (let i = 0; i < macdValues.length; i++) {\n    const hist = macdValues[i].histogram || 0;\n    const sign = hist > 0 ? 1 : hist < 0 ? -1 : 0;\n    \n    if (sign !== currentSign && currentSign !== 0) {\n      const duration = i - periodStart;\n      if (duration > 0 && duration < 60) {\n        momentumPeriods.push(duration);\n      }\n      periodStart = i;\n    }\n    currentSign = sign;\n  }\n  \n  if (momentumPeriods.length >= 3) {\n    const avg = momentumPeriods.reduce((a, b) => a + b, 0) / momentumPeriods.length;\n    return { avgDuration: Math.round(avg), confidence: 'high' };\n  } else if (momentumPeriods.length > 0) {\n    const avg = momentumPeriods.reduce((a, b) => a + b, 0) / momentumPeriods.length;\n    return { avgDuration: Math.round(avg), confidence: 'medium' };\n  }\n  \n  return { avgDuration: 8, confidence: 'low' };\n}\n\nfunction analyzeUptrends(closePrices: number[], prices: any[]): { avgDuration: number; confidence: string } {\n  const ema50 = EMA.calculate({ values: closePrices, period: 50 });\n  \n  const trends: number[] = [];\n  let inUptrend = false;\n  let trendStart = 0;\n  \n  for (let i = 50; i < closePrices.length; i++) {\n    const idx = i - 50;\n    if (idx >= ema50.length) continue;\n    \n    const priceAboveEMA = closePrices[i] > ema50[idx];\n    \n    if (priceAboveEMA && !inUptrend) {\n      inUptrend = true;\n      trendStart = i;\n    } else if (!priceAboveEMA && inUptrend) {\n      const duration = i - trendStart;\n      if (duration > 0 && duration < 90) {\n        trends.push(duration);\n      }\n      inUptrend = false;\n    }\n  }\n  \n  if (trends.length >= 2) {\n    const avg = trends.reduce((a, b) => a + b, 0) / trends.length;\n    return { avgDuration: Math.round(avg), confidence: 'medium' };\n  }\n  \n  return { avgDuration: 14, confidence: 'low' };\n}\n\nfunction analyzeDowntrends(closePrices: number[], prices: any[]): { avgDuration: number; confidence: string } {\n  const ema50 = EMA.calculate({ values: closePrices, period: 50 });\n  \n  const trends: number[] = [];\n  let inDowntrend = false;\n  let trendStart = 0;\n  \n  for (let i = 50; i < closePrices.length; i++) {\n    const idx = i - 50;\n    if (idx >= ema50.length) continue;\n    \n    const priceBelowEMA = closePrices[i] < ema50[idx];\n    \n    if (priceBelowEMA && !inDowntrend) {\n      inDowntrend = true;\n      trendStart = i;\n    } else if (!priceBelowEMA && inDowntrend) {\n      const duration = i - trendStart;\n      if (duration > 0 && duration < 90) {\n        trends.push(duration);\n      }\n      inDowntrend = false;\n    }\n  }\n  \n  if (trends.length >= 2) {\n    const avg = trends.reduce((a, b) => a + b, 0) / trends.length;\n    return { avgDuration: Math.round(avg), confidence: 'medium' };\n  }\n  \n  return { avgDuration: 12, confidence: 'low' };\n}\n\nfunction calculateVolumeDelta(\n  recentPrices: any[],\n  currentVolume: number,\n  priceChangePercent: number\n): { buyVolume: number; sellVolume: number; delta: number; buySellRatio: number } {\n  // Estimate buy/sell volume based on price movement and volume distribution\n  // If price is up, more volume is attributed to buys; if down, to sells\n  \n  let buyVolume = 0;\n  let sellVolume = 0;\n  \n  // Calculate buy/sell ratio from recent price action\n  for (let i = 1; i < recentPrices.length; i++) {\n    const priceChange = recentPrices[i].close - recentPrices[i - 1].close;\n    const volume = recentPrices[i].volume;\n    \n    if (priceChange > 0) {\n      // Price went up - attribute more to buys\n      const buyRatio = Math.min(0.7 + (Math.abs(priceChange) / recentPrices[i].close) * 10, 0.95);\n      buyVolume += volume * buyRatio;\n      sellVolume += volume * (1 - buyRatio);\n    } else if (priceChange < 0) {\n      // Price went down - attribute more to sells\n      const sellRatio = Math.min(0.7 + (Math.abs(priceChange) / recentPrices[i].close) * 10, 0.95);\n      sellVolume += volume * sellRatio;\n      buyVolume += volume * (1 - sellRatio);\n    } else {\n      // No change - split 50/50\n      buyVolume += volume * 0.5;\n      sellVolume += volume * 0.5;\n    }\n  }\n  \n  const delta = buyVolume - sellVolume;\n  const ratio = buyVolume / (sellVolume + 1e-6); // Avoid division by zero\n  \n  return {\n    buyVolume,\n    sellVolume,\n    delta,\n    buySellRatio: ratio,\n  };\n}\n\nfunction calculateSpikeScore(metrics: {\n  volumeDelta: number;\n  rsi: number;\n  momentum: number;\n  volumeChange: number;\n  trendStrength: number;\n}): { score: number; signal: 'SPIKE_SIGNAL' | 'WATCHLIST' | 'NO_SIGNAL'; prediction: string } {\n  // Weighted scoring system (0-100)\n  const weights = {\n    volumeDelta: 0.3,\n    rsi: 0.2,\n    momentum: 0.2,\n    volumeChange: 0.15,\n    trendStrength: 0.15,\n  };\n  \n  // Normalize metrics to 0-100 scale\n  const normalizedVolumeDelta = Math.min(Math.max((metrics.volumeDelta / 1000000) * 50 + 50, 0), 100);\n  const normalizedRSI = metrics.rsi;\n  const normalizedMomentum = Math.min(Math.max(metrics.momentum * 2 + 50, 0), 100);\n  const normalizedVolumeChange = Math.min(Math.max(metrics.volumeChange + 50, 0), 100);\n  const normalizedTrendStrength = Math.min(metrics.trendStrength * 10, 100);\n  \n  // Calculate weighted score\n  const score =\n    weights.volumeDelta * normalizedVolumeDelta +\n    weights.rsi * normalizedRSI +\n    weights.momentum * normalizedMomentum +\n    weights.volumeChange * normalizedVolumeChange +\n    weights.trendStrength * normalizedTrendStrength;\n  \n  // Determine signal level\n  let signal: 'SPIKE_SIGNAL' | 'WATCHLIST' | 'NO_SIGNAL';\n  let prediction: string;\n  \n  if (score > 75) {\n    signal = 'SPIKE_SIGNAL';\n    prediction = 'Strong upward momentum - high probability of price spike';\n  } else if (score > 50) {\n    signal = 'WATCHLIST';\n    prediction = 'Moderate bullish signals - watch for breakout';\n  } else {\n    signal = 'NO_SIGNAL';\n    prediction = 'Weak momentum - no clear entry signal';\n  }\n  \n  return {\n    score: Math.min(Math.max(score, 0), 100),\n    signal,\n    prediction,\n  };\n}\n"],"names":[],"mappings":"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"}